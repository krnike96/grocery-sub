=== Directory Structure ===
â””â”€â”€ Grocery-Sub
    â”œâ”€â”€ backend-grocery
    â”‚   â”œâ”€â”€ .env
    â”‚   â”œâ”€â”€ config
    â”‚   â”‚   â””â”€â”€ db.js
    â”‚   â”œâ”€â”€ controllers
    â”‚   â”‚   â”œâ”€â”€ categoryController.js
    â”‚   â”‚   â”œâ”€â”€ orderController.js
    â”‚   â”‚   â”œâ”€â”€ productController.js
    â”‚   â”‚   â””â”€â”€ userController.js
    â”‚   â”œâ”€â”€ middleware
    â”‚   â”‚   â””â”€â”€ authMiddleware.js
    â”‚   â”œâ”€â”€ models
    â”‚   â”‚   â”œâ”€â”€ categoryModel.js
    â”‚   â”‚   â”œâ”€â”€ orderModel.js
    â”‚   â”‚   â”œâ”€â”€ productModel.js
    â”‚   â”‚   â”œâ”€â”€ subscriptionModel.js
    â”‚   â”‚   â””â”€â”€ userModel.js
    â”‚   â”œâ”€â”€ package.json
    â”‚   â”œâ”€â”€ routes
    â”‚   â”‚   â”œâ”€â”€ categoryRoutes.js
    â”‚   â”‚   â”œâ”€â”€ orderRoutes.js
    â”‚   â”‚   â”œâ”€â”€ productRoutes.js
    â”‚   â”‚   â””â”€â”€ userRoutes.js
    â”‚   â”œâ”€â”€ seeder.js
    â”‚   â”œâ”€â”€ server.js
    â”‚   â””â”€â”€ utils
    â”‚       â””â”€â”€ generateToken.js
    â””â”€â”€ frontend-grocery
        â”œâ”€â”€ README.md
        â”œâ”€â”€ eslint.config.js
        â”œâ”€â”€ index.html
        â”œâ”€â”€ package.json
        â”œâ”€â”€ public
        â”œâ”€â”€ src
        â”‚   â”œâ”€â”€ App.css
        â”‚   â”œâ”€â”€ App.jsx
        â”‚   â”œâ”€â”€ api
        â”‚   â”‚   â””â”€â”€ axios.js
        â”‚   â”œâ”€â”€ assets
        â”‚   â”œâ”€â”€ components
        â”‚   â”‚   â”œâ”€â”€ admin
        â”‚   â”‚   â”‚   â””â”€â”€ Dashboard
        â”‚   â”‚   â”‚       â”œâ”€â”€ Dashboard-component.jsx
        â”‚   â”‚   â”‚       â””â”€â”€ Dashboard-style.js
        â”‚   â”‚   â”œâ”€â”€ auth
        â”‚   â”‚   â”‚   â”œâ”€â”€ Login
        â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ Login-component.jsx
        â”‚   â”‚   â”‚   â”‚   â””â”€â”€ Login-style.js
        â”‚   â”‚   â”‚   â”œâ”€â”€ ProtectedRoute.jsx
        â”‚   â”‚   â”‚   â””â”€â”€ Register
        â”‚   â”‚   â”‚       â”œâ”€â”€ Register-component.jsx
        â”‚   â”‚   â”‚       â””â”€â”€ Register-style.js
        â”‚   â”‚   â”œâ”€â”€ cart
        â”‚   â”‚   â”‚   â””â”€â”€ Checkout
        â”‚   â”‚   â”‚       â”œâ”€â”€ Checkout-component.jsx
        â”‚   â”‚   â”‚       â””â”€â”€ Checkout-style.js
        â”‚   â”‚   â”œâ”€â”€ delivery
        â”‚   â”‚   â”‚   â””â”€â”€ Dashboard
        â”‚   â”‚   â”‚       â”œâ”€â”€ Dashboard-component.jsx
        â”‚   â”‚   â”‚       â””â”€â”€ Dashboard-style.js
        â”‚   â”‚   â”œâ”€â”€ layout
        â”‚   â”‚   â”‚   â””â”€â”€ Navbar
        â”‚   â”‚   â”‚       â”œâ”€â”€ Navbar-component.jsx
        â”‚   â”‚   â”‚       â””â”€â”€ Navbar-style.js
        â”‚   â”‚   â””â”€â”€ user
        â”‚   â”‚       â””â”€â”€ Dashboard
        â”‚   â”‚           â”œâ”€â”€ Dashboard-component.jsx
        â”‚   â”‚           â””â”€â”€ Dashboard-style.js
        â”‚   â”œâ”€â”€ context
        â”‚   â”‚   â”œâ”€â”€ AuthContext.jsx
        â”‚   â”‚   â””â”€â”€ CartContext.jsx
        â”‚   â”œâ”€â”€ data
        â”‚   â”‚   â””â”€â”€ groceryData.js
        â”‚   â”œâ”€â”€ index.css
        â”‚   â”œâ”€â”€ main.jsx
        â”‚   â””â”€â”€ styles
        â”‚       â””â”€â”€ GlobalStyle.js
        â”œâ”€â”€ vercel.json
        â””â”€â”€ vite.config.js

=== File Contents ===

--- File: backend-grocery\.env ---

PORT=5000
MONGO_URI=mongodb://127.0.0.1:27017/grocery-db
JWT_SECRET=my_super_secret_key_123

--- File: backend-grocery\package.json ---

{
  "name": "backend-grocery",
  "version": "1.0.0",
  "description": "",
  "main": "server.js",
  "type": "module",
  "scripts": {
    "test": "echo \"Error: no test specified\" && exit 1",
    "start": "node server.js",
    "dev": "nodemon server.js",
    "data:import": "node seeder.js",
    "data:destroy": "node seeder.js -d"
  },
  "keywords": [],
  "author": "",
  "license": "ISC",
  "dependencies": {
    "bcryptjs": "^3.0.3",
    "cors": "^2.8.5",
    "dotenv": "^17.2.3",
    "express": "^5.2.1",
    "jsonwebtoken": "^9.0.3",
    "mongoose": "^9.0.1"
  },
  "devDependencies": {
    "nodemon": "^3.1.11"
  }
}


--- File: backend-grocery\seeder.js ---

import mongoose from "mongoose";
import dotenv from "dotenv";
import connectDB from "./config/db.js";
import Product from "./models/productModel.js";
import Category from "./models/categoryModel.js";
import User from "./models/userModel.js";

dotenv.config();
connectDB();

const categories = [
  {
    name: "Fresh Vegetables",
    image:
      "https://images.unsplash.com/photo-1566385101042-1a0aa0c1268c?auto=format&fit=crop&q=80&w=300",
    desc: "Farm fresh veggies direct from the field.",
  },
  {
    name: "Fresh Fruits",
    image:
      "https://images.unsplash.com/photo-1619566636858-adf3ef46400b?auto=format&fit=crop&q=80&w=300",
    desc: "Seasonal, exotic, and daily fruits.",
  },
  {
    name: "Dairy & Breakfast",
    image:
      "https://images.unsplash.com/photo-1628088062854-d1870b4553da?auto=format&fit=crop&q=80&w=300",
    desc: "Milk, Curd, Bread, Eggs & Butter.",
  },
  {
    name: "Munchies & Snacks",
    image:
      "https://images.unsplash.com/photo-1621447504864-d8686e12698c?auto=format&fit=crop&q=80&w=300",
    desc: "Chips, Biscuits, Namkeen & Popcorn.",
  },
];

const products = [
  {
    name: "Potato (Aloo)",
    category: "Fresh Vegetables",
    price: 30,
    unit: "1 kg",
    image:
      "https://images.unsplash.com/photo-1518977676601-b53f8aba655?auto=format&fit=crop&q=80&w=300",
    stock: 100,
  },
  {
    name: "Onion",
    category: "Fresh Vegetables",
    price: 40,
    unit: "1 kg",
    image:
      "https://images.unsplash.com/photo-1618512496248-a07fe83aa8cb?auto=format&fit=crop&q=80&w=300",
    stock: 100,
  },
  {
    name: "Banana",
    category: "Fresh Fruits",
    price: 60,
    unit: "1 Dozen",
    image:
      "https://images.unsplash.com/photo-1571771894821-ce9b6c11b08e?auto=format&fit=crop&q=80&w=300",
    stock: 50,
  },
  {
    name: "Full Cream Milk",
    category: "Dairy & Breakfast",
    price: 64,
    unit: "1 Liter",
    image:
      "https://images.unsplash.com/photo-1563636619-e9143da7973b?auto=format&fit=crop&q=80&w=300",
    stock: 40,
  },
];

const importData = async () => {
  try {
    await Category.deleteMany();
    await Product.deleteMany();

    await Category.insertMany(categories);
    await Product.insertMany(products);

    console.log("Data Imported Successfully!");
    process.exit();
  } catch (error) {
    console.error(`${error}`);
    process.exit(1);
  }
};

importData();


--- File: backend-grocery\server.js ---

import express from "express";
import dotenv from "dotenv";
import cors from "cors";
import connectDB from "./config/db.js";
import productRoutes from "./routes/productRoutes.js";
import userRoutes from "./routes/userRoutes.js";
import categoryRoutes from "./routes/categoryRoutes.js";
import orderRoutes from "./routes/orderRoutes.js";

dotenv.config();

connectDB();

const app = express();
app.use(express.json());
app.use(cors());

app.use("/api/products", productRoutes);
app.use("/api/users", userRoutes);
app.use("/api/categories", categoryRoutes);
app.use("/api/orders", orderRoutes);

app.get("/", (req, res) => {
  res.send("API is running and Database is connected...");
});

// Error Handling Middleware
app.use((err, req, res, next) => {
  const statusCode = res.statusCode === 200 ? 500 : res.statusCode;
  res.status(statusCode).json({
    message: err.message,
    stack: process.env.NODE_ENV === "production" ? null : err.stack,
  });
});

const PORT = process.env.PORT || 5000;
app.listen(PORT, () => {
  console.log(`Server running on port ${PORT}`);
});


--- File: backend-grocery\config\db.js ---

import mongoose from "mongoose";

const connectDB = async () => {
  try {
    const conn = await mongoose.connect(process.env.MONGO_URI);
    console.log(`MongoDB Connected: ${conn.connection.host}`);
  } catch (error) {
    console.error(`Error: ${error.message}`);
    process.exit(1);
  }
};

export default connectDB;


--- File: backend-grocery\controllers\categoryController.js ---

import Category from "../models/categoryModel.js";

export const createCategory = async (req, res) => {
  try {
    const { name, image, desc } = req.body;
    const category = new Category({ name, image, desc });
    const createdCategory = await category.save();
    res.status(201).json(createdCategory);
  } catch (error) {
    res
      .status(400)
      .json({
        success: false,
        message: error.message || "Invalid category data",
      });
  }
};

export const getCategories = async (req, res) => {
  try {
    const categories = await Category.find({});
    res.json(categories);
  } catch (error) {
    res.status(500).json({ success: false, message: "Server Error" });
  }
};


--- File: backend-grocery\controllers\orderController.js ---

import Order from "../models/orderModel.js";
import Product from "../models/productModel.js"; // Import Product model
import Subscription from "../models/subscriptionModel.js";

// @desc    Create new order
// @route   POST /api/orders
export const addOrderItems = async (req, res) => {
  try {
    if (!req.body) {
      return res.status(400).json({ message: "No request body found" });
    }
    const {
      orderItems,
      subscriptions,
      shippingAddress,
      totalPrice,
      paymentMethod,
    } = req.body;

    if (
      (!orderItems || orderItems.length === 0) &&
      (!subscriptions || subscriptions.length === 0)
    ) {
      return res.status(400).json({ message: "No items provided" });
    }

    // 1. Verify Stock for One-Time Items BEFORE creating order
    if (orderItems && orderItems.length > 0) {
      for (const item of orderItems) {
        const product = await Product.findById(item.product);
        if (!product) {
          return res
            .status(404)
            .json({ message: `Product not found: ${item.name}` });
        }
        if (product.stock < item.qty) {
          return res.status(400).json({
            message: `Insufficient stock for ${item.name}. Only ${product.stock} left.`,
          });
        }
      }
    }

    const order = new Order({
      user: req.user._id,
      orderItems,
      shippingAddress,
      paymentMethod,
      totalPrice,
      isPaid: true,
      paidAt: Date.now(),
      status: "Pending",
    });

    const createdOrder = await order.save();

    if (subscriptions && subscriptions.length > 0) {
      const subDocs = subscriptions.map((sub) => ({
        user: req.user._id,
        product: sub.product,
        frequency: sub.frequency,
        status: "Active",
        startDate: new Date(),
      }));
      await Subscription.insertMany(subDocs);
    }

    res.status(201).json({ success: true, order: createdOrder });
  } catch (error) {
    res.status(500).json({ message: error.message });
  }
};

// @desc    Get all orders (Admin)
export const getOrders = async (req, res) => {
  const orders = await Order.find({}).populate("user", "id name email");
  res.json(orders);
};

// @desc    Update order status & Deduct Stock
// @route   PUT /api/orders/:id/status
export const updateOrderStatus = async (req, res) => {
  const order = await Order.findById(req.params.id);

  if (order) {
    order.status = req.body.status || order.status;

    // IF STATUS IS 'DELIVERED', DEDUCT STOCK
    if (req.body.status === "Delivered" && !order.isDelivered) {
      order.isDelivered = true;
      order.deliveredAt = Date.now();

      // Loop through order items and update product stock
      for (const item of order.orderItems) {
        const product = await Product.findById(item.product);
        if (product) {
          product.stock = product.stock - item.qty;
          await product.save();
        }
      }
    }

    const updatedOrder = await order.save();
    res.json(updatedOrder);
  } else {
    res.status(404).json({ message: "Order not found" });
  }
};

// @desc    Delete order
export const deleteOrder = async (req, res) => {
  const order = await Order.findById(req.params.id);
  if (order) {
    await order.deleteOne();
    res.json({ message: "Order removed" });
  } else {
    res.status(404).json({ message: "Order not found" });
  }
};

export const getMySubscriptions = async (req, res) => {
  const subs = await Subscription.find({ user: req.user._id }).populate(
    "product"
  );
  res.json(subs);
};

export const cancelSubscription = async (req, res) => {
  const sub = await Subscription.findById(req.params.id);
  if (sub && sub.user.toString() === req.user._id.toString()) {
    sub.status = "Cancelled";
    await sub.save();
    res.json({ message: "Subscription cancelled successfully" });
  } else {
    res.status(404).json({ message: "Subscription not found" });
  }
};


--- File: backend-grocery\controllers\productController.js ---

import Product from "../models/productModel.js";

export const getProducts = async (req, res) => {
  try {
    const products = await Product.find({});
    res.json(products);
  } catch (error) {
    res.status(500).json({
      success: false,
      message: "Server Error: Could not fetch products",
    });
  }
};

export const getProductById = async (req, res) => {
  try {
    const product = await Product.findById(req.params.id);
    if (product) {
      res.json(product);
    } else {
      res.status(404).json({ success: false, message: "Product not found" });
    }
  } catch (error) {
    res.status(500).json({ success: false, message: "Server Error" });
  }
};

export const deleteProduct = async (req, res) => {
  try {
    const product = await Product.findById(req.params.id);
    if (product) {
      await product.deleteOne();
      res.json({ message: "Product removed" });
    } else {
      res.status(404).json({ success: false, message: "Product not found" });
    }
  } catch (error) {
    res.status(500).json({ message: error.message });
  }
};

export const createProduct = async (req, res) => {
  try {
    const { name, price, image, category, unit, stock, description } = req.body;
    const product = new Product({
      name,
      price,
      image,
      category,
      unit: unit || "1 unit",
      stock: stock || 0,
      description: description || "",
      user: "6418ae99b01f348b2f964444",
    });
    const createdProduct = await product.save();
    res.status(201).json(createdProduct);
  } catch (error) {
    res.status(400).json({
      success: false,
      message: error.message || "Invalid product data",
    });
  }
};

export const updateProduct = async (req, res) => {
  try {
    const { name, price, description, image, category, stock, unit } = req.body;
    const product = await Product.findById(req.params.id);

    if (product) {
      product.name = name || product.name;
      product.price = price || product.price;
      product.description = description || product.description;
      product.image = image || product.image;
      product.category = category || product.category;
      product.stock = stock !== undefined ? stock : product.stock;
      product.unit = unit || product.unit;

      const updatedProduct = await product.save();
      res.json(updatedProduct);
    } else {
      res.status(404).json({ message: "Product not found" });
    }
  } catch (error) {
    res.status(500).json({ message: error.message });
  }
};


--- File: backend-grocery\controllers\userController.js ---

import User from "../models/userModel.js";
import generateToken from "../utils/generateToken.js";

export const registerUser = async (req, res) => {
  const { name, email, password } = req.body;

  const userExists = await User.findOne({ email });

  if (userExists) {
    return res
      .status(400)
      .json({ success: false, message: "User already exists" });
  }

  const user = await User.create({
    name,
    email,
    password,
  });

  if (user) {
    res.status(201).json({
      _id: user._id,
      name: user.name,
      email: user.email,
      isAdmin: user.isAdmin,
      token: generateToken(user._id),
    });
  } else {
    res.status(400).json({ success: false, message: "Invalid user data" });
  }
};

export const authUser = async (req, res) => {
  const { email, password } = req.body;

  const user = await User.findOne({ email });

  if (user && (await user.matchPassword(password))) {
    res.json({
      _id: user._id,
      name: user.name,
      email: user.email,
      isAdmin: user.isAdmin,
      token: generateToken(user._id),
    });
  } else {
    res
      .status(401)
      .json({ success: false, message: "Invalid email or password" });
  }
};

export const getUsers = async (req, res) => {
  const users = await User.find({}).select("-password");
  if (users) {
    res.json(users);
  } else {
    res.status(404).json({
      success: false,
      message: "Users not found",
    });
  }
};

export const deleteUser = async (req, res) => {
  const user = await User.findById(req.params.id);
  if (user) {
    if (user.isAdmin)
      return res.status(400).json({ message: "Cannot delete admin" });
    await user.deleteOne();
    res.json({ message: "User removed successfully" });
  } else {
    res.status(404).json({ message: "User not found" });
  }
};

export const updateUserByAdmin = async (req, res) => {
  const user = await User.findById(req.params.id);
  if (user) {
    user.name = req.body.name || user.name;
    user.email = req.body.email || user.email;
    if (req.body.isAdmin !== undefined) user.isAdmin = req.body.isAdmin;

    const updatedUser = await user.save();
    res.json(updatedUser);
  } else {
    res.status(404).json({ message: "User not found" });
  }
};

export const updateUserProfile = async (req, res) => {
  const user = await User.findById(req.user._id);

  if (user) {
    user.name = req.body.name || user.name;
    user.email = req.body.email || user.email;
    if (req.body.password) {
      user.password = req.body.password;
    }

    // Update Address
    if (req.body.defaultAddress) {
      user.defaultAddress = req.body.defaultAddress;
    }

    const updatedUser = await user.save();

    res.json({
      _id: updatedUser._id,
      name: updatedUser.name,
      email: updatedUser.email,
      isAdmin: updatedUser.isAdmin,
      defaultAddress: updatedUser.defaultAddress, // Return address
      token: generateToken(updatedUser._id),
    });
  } else {
    res.status(404).json({ message: "User not found" });
  }
};

export const getCart = async (req, res) => {
  const user = await User.findById(req.user._id);
  res.json(user.cart || { orderItems: [], subscriptions: [] });
};

export const saveCart = async (req, res) => {
  const user = await User.findById(req.user._id);
  if (user) {
    user.cart = req.body;
    await user.save();
    res.json({ message: "Cart saved" });
  } else {
    res.status(404).json({ message: "User not found" });
  }
};


--- File: backend-grocery\middleware\authMiddleware.js ---

import jwt from "jsonwebtoken";
import User from "../models/userModel.js";

export const protect = async (req, res, next) => {
  let token;

  if (
    req.headers.authorization &&
    req.headers.authorization.startsWith("Bearer")
  ) {
    try {
      token = req.headers.authorization.split(" ")[1];
      const decoded = jwt.verify(token, process.env.JWT_SECRET);

      // Attaching user to request, excluding password
      req.user = await User.findById(decoded.id).select("-password");

      if (!req.user) {
        return res.status(401).json({ message: "User not found" });
      }

      next();
    } catch (error) {
      console.error(error);
      res.status(401).json({ message: "Not authorized, token failed" });
    }
  }

  if (!token) {
    res.status(401).json({ message: "Not authorized, no token" });
  }
};

export const admin = (req, res, next) => {
  if (req.user && req.user.isAdmin) {
    next();
  } else {
    res.status(401).json({ message: "Not authorized as an admin" });
  }
};


--- File: backend-grocery\models\categoryModel.js ---

import mongoose from "mongoose";

const categorySchema = mongoose.Schema(
  {
    name: { type: String, required: true, unique: true },
    image: { type: String, required: true },
    desc: { type: String },
  },
  { timestamps: true }
);

const Category = mongoose.model("Category", categorySchema);
export default Category;


--- File: backend-grocery\models\orderModel.js ---

import mongoose from "mongoose";

const orderSchema = mongoose.Schema(
  {
    user: {
      type: mongoose.Schema.Types.ObjectId,
      required: true,
      ref: "User",
    },
    orderItems: [
      {
        name: { type: String, required: true },
        qty: { type: Number, required: true },
        image: { type: String, required: true },
        price: { type: Number, required: true },
        product: {
          type: mongoose.Schema.Types.ObjectId,
          required: true,
          ref: "Product",
        },
      },
    ],
    shippingAddress: {
      address: { type: String, required: true },
      city: { type: String, required: true },
      postalCode: { type: String, required: true },
    },
    paymentResult: {
      id: { type: String },
      status: { type: String },
      update_time: { type: String },
      email_address: { type: String },
    },
    totalPrice: {
      type: Number,
      required: true,
      default: 0.0,
    },
    isPaid: {
      type: Boolean,
      required: true,
      default: false,
    },
    paidAt: {
      type: Date,
    },
  },
  {
    timestamps: true,
  }
);

const Order = mongoose.model("Order", orderSchema);
export default Order;


--- File: backend-grocery\models\productModel.js ---

import mongoose from "mongoose";

const productSchema = mongoose.Schema(
  {
    name: {
      type: String,
      required: true,
    },
    category: {
      type: String,
      required: true,
    },
    price: {
      type: Number,
      required: true,
      default: 0,
    },
    unit: {
      type: String, 
      required: true,
    },
    image: {
      type: String,
      required: true,
    },
    stock: {
      type: Number,
      required: true,
      default: 0,
    },
    description: {
      type: String,
      required: false,
    },
  },
  {
    timestamps: true,
  }
);

const Product = mongoose.model("Product", productSchema);

export default Product;


--- File: backend-grocery\models\subscriptionModel.js ---

import mongoose from "mongoose";

const subscriptionSchema = mongoose.Schema(
  {
    user: { type: mongoose.Schema.Types.ObjectId, required: true, ref: "User" },
    product: {
      type: mongoose.Schema.Types.ObjectId,
      required: true,
      ref: "Product",
    },
    frequency: { type: String, required: true, default: "Daily" }, // Daily, Weekly
    startDate: { type: Date, required: true, default: Date.now },
    status: { type: String, required: true, default: "Active" }, // Active, Paused, Cancelled
    nextDelivery: { type: Date },
  },
  { timestamps: true }
);

const Subscription = mongoose.model("Subscription", subscriptionSchema);
export default Subscription;


--- File: backend-grocery\models\userModel.js ---

import mongoose from "mongoose";
import bcrypt from "bcryptjs";

const userSchema = mongoose.Schema(
  {
    name: {
      type: String,
      required: true,
    },
    email: {
      type: String,
      required: true,
      unique: true,
    },
    password: {
      type: String,
      required: true,
    },
    isAdmin: {
      type: Boolean,
      required: true,
      default: false,
    },
    defaultAddress: {
      address: { type: String, default: "" },
      city: { type: String, default: "" },
      postalCode: { type: String, default: "" },
    },
    // [cite_start]:82,// Add cart field for persistence [cite: 82]
    cart: {
      orderItems: [
        {
          product: { type: mongoose.Schema.Types.ObjectId, ref: "Product" },
          name: String,
          price: Number,
          image: String,
          qty: Number,
          stock: Number,
        },
      ],
      subscriptions: [
        {
          product: { type: mongoose.Schema.Types.ObjectId, ref: "Product" },
          name: String,
          price: Number,
          image: String,
          frequency: { type: String, default: "Daily" },
        },
      ],
    },
  },
  {
    timestamps: true,
  }
);

userSchema.methods.matchPassword = async function (enteredPassword) {
  return await bcrypt.compare(enteredPassword, this.password);
};

// Middleware to hash password before saving to DB
userSchema.pre("save", async function (next) {
  if (!this.isModified("password")) {
    next();
  }
  const salt = await bcrypt.genSalt(10);
  this.password = await bcrypt.hash(this.password, salt);
});

const User = mongoose.model("User", userSchema);

export default User;


--- File: backend-grocery\routes\categoryRoutes.js ---

import express from "express";
import { createCategory, getCategories } from "../controllers/categoryController.js";

const router = express.Router();

router.post("/", createCategory );
router.get("/get-categories", getCategories)

export default router;


--- File: backend-grocery\routes\orderRoutes.js ---

import express from "express";
import {
  addOrderItems,
  getOrders,
  updateOrderStatus,
  deleteOrder,
  getMySubscriptions,
  cancelSubscription,
} from "../controllers/orderController.js";
import { protect, admin } from "../middleware/authMiddleware.js";

const router = express.Router();

router.route("/").post(protect, addOrderItems).get(protect, admin, getOrders);

router.get("/my-subscriptions", protect, getMySubscriptions);
router.put("/subscription/:id/cancel", protect, cancelSubscription);

router.route("/:id").delete(protect, admin, deleteOrder);

router.put("/:id/status", protect, admin, updateOrderStatus);

export default router;


--- File: backend-grocery\routes\productRoutes.js ---

import express from "express";
import {
  getProducts,
  getProductById,
  createProduct,
  deleteProduct,
  updateProduct,
} from "../controllers/productController.js";

const router = express.Router();

router.get("/", getProducts);
router.post("/", createProduct);
router.get("/:id", getProductById);
router.delete("/:id", deleteProduct);
router.put("/:id", updateProduct);

export default router;


--- File: backend-grocery\routes\userRoutes.js ---

import express from "express";
import {
  registerUser,
  authUser,
  getUsers,
  updateUserProfile,
  saveCart,
  getCart,
  deleteUser,
  updateUserByAdmin,
} from "../controllers/userController.js";
import { protect, admin } from "../middleware/authMiddleware.js";

const router = express.Router();

router.post("/", registerUser);
router.post("/login", authUser);

router.get("/profile", protect, (req, res) => res.json(req.user)); // Get current user data
router.put("/profile", protect, updateUserProfile);

router.route("/cart").get(protect, getCart).post(protect, saveCart);

router.get("/", protect, admin, getUsers);
router
  .route("/:id")
  .delete(protect, admin, deleteUser)
  .put(protect, admin, updateUserByAdmin);

export default router;


--- File: backend-grocery\utils\generateToken.js ---

import jwt from "jsonwebtoken";

const generateToken = (id) => {
  return jwt.sign({ id }, process.env.JWT_SECRET, {
    expiresIn: "30d",
  });
};

export default generateToken;


--- File: frontend-grocery\eslint.config.js ---

import js from '@eslint/js'
import globals from 'globals'
import reactHooks from 'eslint-plugin-react-hooks'
import reactRefresh from 'eslint-plugin-react-refresh'
import { defineConfig, globalIgnores } from 'eslint/config'

export default defineConfig([
  globalIgnores(['dist']),
  {
    files: ['**/*.{js,jsx}'],
    extends: [
      js.configs.recommended,
      reactHooks.configs.flat.recommended,
      reactRefresh.configs.vite,
    ],
    languageOptions: {
      ecmaVersion: 2020,
      globals: globals.browser,
      parserOptions: {
        ecmaVersion: 'latest',
        ecmaFeatures: { jsx: true },
        sourceType: 'module',
      },
    },
    rules: {
      'no-unused-vars': ['error', { varsIgnorePattern: '^[A-Z_]' }],
    },
  },
])


--- File: frontend-grocery\index.html ---

<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <!-- <link rel="icon" type="image/svg+xml" href="/vite.svg" /> -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ðŸ¥¦ Grocery Sub</title>
  </head>
  <body>
    <div id="root"></div>
    <script type="module" src="/src/main.jsx"></script>
  </body>
</html>


--- File: frontend-grocery\package.json ---

{
  "name": "grocery_frontend_vite",
  "private": true,
  "version": "0.0.0",
  "type": "module",
  "scripts": {
    "dev": "vite",
    "build": "vite build",
    "lint": "eslint .",
    "preview": "vite preview"
  },
  "dependencies": {
    "axios": "^1.13.2",
    "lucide-react": "^0.561.0",
    "react": "^19.2.0",
    "react-dom": "^19.2.0",
    "react-router-dom": "^7.10.1",
    "react-toastify": "^11.0.5",
    "styled-components": "^6.1.19"
  },
  "devDependencies": {
    "@eslint/js": "^9.39.1",
    "@types/react": "^19.2.5",
    "@types/react-dom": "^19.2.3",
    "@vitejs/plugin-react": "^5.1.1",
    "eslint": "^9.39.1",
    "eslint-plugin-react-hooks": "^7.0.1",
    "eslint-plugin-react-refresh": "^0.4.24",
    "globals": "^16.5.0",
    "vite": "^7.2.4"
  }
}


--- File: frontend-grocery\README.md ---

# React + Vite Project : Subscription based Grocery Delivery System

# Routes for Test

````https://grocery-sub-delivery-project.vercel.app/

``` https://grocery-sub-delivery-project.vercel.app/login

``` https://grocery-sub-delivery-project.vercel.app/register

``` https://grocery-sub-delivery-project.vercel.app/admin

``` https://grocery-sub-delivery-project.vercel.app/delivery

``` https://grocery-sub-delivery-project.vercel.app/cart
````


--- File: frontend-grocery\vercel.json ---

{
  "rewrites": [
    {
      "source": "/(.*)",
      "destination": "/index.html"
    }
  ]
}


--- File: frontend-grocery\vite.config.js ---

import { defineConfig } from 'vite'
import react from '@vitejs/plugin-react'

// https://vite.dev/config/
export default defineConfig({
  plugins: [react()],
})


--- File: frontend-grocery\src\App.css ---

#root {
  max-width: 1280px;
  margin: 0 auto;
  padding: 2rem;
  text-align: center;
}

.logo {
  height: 6em;
  padding: 1.5em;
  will-change: filter;
  transition: filter 300ms;
}
.logo:hover {
  filter: drop-shadow(0 0 2em #646cffaa);
}
.logo.react:hover {
  filter: drop-shadow(0 0 2em #61dafbaa);
}

@keyframes logo-spin {
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
}

@media (prefers-reduced-motion: no-preference) {
  a:nth-of-type(2) .logo {
    animation: logo-spin infinite 20s linear;
  }
}

.card {
  padding: 2em;
}

.read-the-docs {
  color: #888;
}


--- File: frontend-grocery\src\App.jsx ---

import React from "react";
import { BrowserRouter as Router, Routes, Route } from "react-router-dom";
import { ToastContainer } from "react-toastify";
import "react-toastify/dist/ReactToastify.css";
import styled from "styled-components";

import { AuthProvider } from "./context/AuthContext";
import ProtectedRoute from "./components/auth/ProtectedRoute";

import Navbar from "./components/layout/Navbar/Navbar-component";
import RegisterPage from "./components/auth/Register/Register-component";
import LoginPage from "./components/auth/Login/Login-component";
import UserDashboard from "./components/user/Dashboard/Dashboard-component.jsx";
import AdminDashboard from "./components/admin/Dashboard/Dashboard-component.jsx";
import DeliveryDashboard from "./components/delivery/Dashboard/Dashboard-component.jsx";
import CheckoutPage from "./components/cart/Checkout/Checkout-component.jsx";
import { CartProvider } from "./context/CartContext.jsx";

// --- STYLED COMPONENTS (Preserved) ---
const Layout = styled.div`
  display: flex;
  flex-direction: column;
  min-height: 100vh;
`;

const MainContent = styled.main`
  flex-grow: 1;
  padding: 20px 0;
  width: 90%;
  max-width: 1200px;
  margin: 0 auto;
`;

function App() {
  return (
    <AuthProvider>
      <CartProvider>
      <Router>
        <Layout>
          <Navbar />

          <MainContent>
            <Routes>
              {/* Public Routes */}
              <Route path="/login" element={<LoginPage />} />
              <Route path="/register" element={<RegisterPage />} />
              <Route path="/" element={<UserDashboard />} />

              {/* Protected User Routes */}
              <Route
                path="/cart"
                element={
                  <ProtectedRoute>
                    <CheckoutPage />
                  </ProtectedRoute>
                }
              />

              {/* Protected Admin Routes */}
              <Route
                path="/admin"
                element={
                  <ProtectedRoute isAdmin={true}>
                    <AdminDashboard />
                  </ProtectedRoute>
                }
              />

              {/* Protected Delivery Routes */}
              <Route
                path="/delivery"
                element={
                  <ProtectedRoute>
                    <DeliveryDashboard />
                  </ProtectedRoute>
                }
              />
            </Routes>
          </MainContent>

          <ToastContainer position="top-center" autoClose={3000} />
        </Layout>
      </Router>
      </CartProvider>
    </AuthProvider>
  );
}

export default App;


--- File: frontend-grocery\src\index.css ---

:root {
  font-family: system-ui, Avenir, Helvetica, Arial, sans-serif;
  line-height: 1.5;
  font-weight: 400;

  color-scheme: light dark;
  color: rgba(255, 255, 255, 0.87);
  background-color: #242424;

  font-synthesis: none;
  text-rendering: optimizeLegibility;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

a {
  font-weight: 500;
  color: #646cff;
  text-decoration: inherit;
}
a:hover {
  color: #535bf2;
}

body {
  margin: 0;
  display: flex;
  place-items: center;
  min-width: 320px;
  min-height: 100vh;
}

h1 {
  font-size: 3.2em;
  line-height: 1.1;
}

button {
  border-radius: 8px;
  border: 1px solid transparent;
  padding: 0.6em 1.2em;
  font-size: 1em;
  font-weight: 500;
  font-family: inherit;
  background-color: #1a1a1a;
  cursor: pointer;
  transition: border-color 0.25s;
}
button:hover {
  border-color: #646cff;
}
button:focus,
button:focus-visible {
  outline: 4px auto -webkit-focus-ring-color;
}

@media (prefers-color-scheme: light) {
  :root {
    color: #213547;
    background-color: #ffffff;
  }
  a:hover {
    color: #747bff;
  }
  button {
    background-color: #f9f9f9;
  }
}


--- File: frontend-grocery\src\main.jsx ---

// src/main.jsx (Corrected Code)

import React from 'react'; // Standard import
import ReactDOM from 'react-dom/client'; // Corrected import path for createRoot
import App from './App.jsx';
import { GlobalStyle } from './styles/GlobalStyle.js';
import 'react-toastify/dist/ReactToastify.css';
import { AuthProvider } from './context/AuthContext.jsx';

// We must call createRoot on the container element
ReactDOM.createRoot(document.getElementById('root')).render(
  <React.StrictMode>
    <GlobalStyle />
    <AuthProvider> 
      <App />
    </AuthProvider>
  </React.StrictMode>,
);

--- File: frontend-grocery\src\api\axios.js ---

import axios from "axios";

const API = axios.create({
  baseURL: "http://localhost:5000/api",
});

export default API;


--- File: frontend-grocery\src\components\admin\Dashboard\Dashboard-component.jsx ---

import React, { useState, useEffect } from "react";
import { toast } from "react-toastify";
import { Trash2, CheckCircle, Truck, Edit3, Save, X } from "lucide-react";
import API from "../../../api/axios";
import {
  AdminDashboardContainer,
  TabContainer,
  TabButton,
  FormCard,
  FormTitle,
  FormGroup,
  Label,
  Input,
  Select,
  PrimaryButton,
  TableContainer,
  Table,
  ActionButton,
} from "./Dashboard-style";

const AdminDashboard = () => {
  const [activeTab, setActiveTab] = useState("orders");
  const [orders, setOrders] = useState([]);
  const [products, setProducts] = useState([]);
  const [categories, setCategories] = useState([]);
  const [users, setUsers] = useState([]);

  // State for inline stock editing
  const [editStockId, setEditStockId] = useState(null);
  const [newStockValue, setNewStockValue] = useState("");

  const [productData, setProductData] = useState({
    name: "",
    price: "",
    category: "",
    unit: "",
    stock: "",
    image: "",
    description: "",
  });
  const [categoryData, setCategoryData] = useState({
    name: "",
    image: "",
    desc: "",
  });

  const fetchAllData = async () => {
    try {
      const [ordRes, prodRes, catRes, userRes] = await Promise.all([
        API.get("/orders"),
        API.get("/products"),
        API.get("/categories/get-categories"),
        API.get("/users"),
      ]);
      setOrders(ordRes.data);
      setProducts(prodRes.data);
      setCategories(catRes.data);
      setUsers(userRes.data);
    } catch (err) {
      toast.error("Error fetching dashboard data");
    }
  };

  useEffect(() => {
    fetchAllData();
  }, [activeTab]);

  // --- HANDLERS ---
  const handleUpdateOrderStatus = async (id, status) => {
    try {
      await API.put(`/orders/${id}/status`, { status });
      toast.success(`Order updated to ${status}`);
      fetchAllData();
    } catch (err) {
      toast.error("Update failed");
    }
  };

  const handleDeleteOrder = async (id) => {
    if (window.confirm("Delete this order?")) {
      try {
        await API.delete(`/orders/${id}`);
        toast.success("Order Deleted");
        fetchAllData();
      } catch (err) {
        toast.error("Delete failed");
      }
    }
  };

  const handleProductSubmit = async (e) => {
    e.preventDefault();
    try {
      await API.post("/products", {
        ...productData,
        price: Number(productData.price),
        stock: Number(productData.stock),
      });
      toast.success("Product added!");
      setProductData({
        name: "",
        price: "",
        category: "",
        unit: "",
        stock: "",
        image: "",
        description: "",
      });
      fetchAllData();
    } catch (err) {
      toast.error("Failed to add product");
    }
  };

  const handleUpdateStock = async (id) => {
    try {
      await API.put(`/products/${id}`, { stock: Number(newStockValue) });
      toast.success("Stock updated");
      setEditStockId(null);
      fetchAllData();
    } catch (err) {
      toast.error("Stock update failed");
    }
  };

  const deleteProductHandler = async (id) => {
    if (window.confirm("Delete product?")) {
      try {
        await API.delete(`/products/${id}`);
        toast.success("Product deleted");
        fetchAllData();
      } catch (err) {
        toast.error("Delete failed");
      }
    }
  };

  const handleCategorySubmit = async (e) => {
    e.preventDefault();
    try {
      await API.post("/categories", categoryData);
      toast.success("Category created");
      setCategoryData({ name: "", image: "", desc: "" });
      fetchAllData();
    } catch (err) {
      toast.error("Failed to create category");
    }
  };

  const deleteUserHandler = async (id) => {
    if (window.confirm("Permanently delete user?")) {
      try {
        await API.delete(`/users/${id}`);
        toast.success("User deleted");
        fetchAllData();
      } catch (err) {
        toast.error("Cannot delete Admin or User not found");
      }
    }
  };

  return (
    <AdminDashboardContainer>
      <TabContainer>
        <TabButton
          $active={activeTab === "orders"}
          onClick={() => setActiveTab("orders")}
        >
          Orders
        </TabButton>
        <TabButton
          $active={activeTab === "products"}
          onClick={() => setActiveTab("products")}
        >
          Products & Stock
        </TabButton>
        <TabButton
          $active={activeTab === "categories"}
          onClick={() => setActiveTab("categories")}
        >
          Categories
        </TabButton>
        <TabButton
          $active={activeTab === "users"}
          onClick={() => setActiveTab("users")}
        >
          Users
        </TabButton>
      </TabContainer>

      {/* --- ORDERS TAB --- */}
      {activeTab === "orders" && (
        <FormCard style={{ maxWidth: "100%" }}>
          <FormTitle>Live Order Management</FormTitle>
          <TableContainer>
            <Table>
              <thead>
                <tr>
                  <th>ID</th>
                  <th>Customer</th>
                  <th>Total</th>
                  <th>Status</th>
                  <th>Actions</th>
                </tr>
              </thead>
              <tbody>
                {orders.map((order) => (
                  <tr key={order._id}>
                    <td>{order._id.slice(-6)}</td>
                    <td>{order.user?.name}</td>
                    <td>â‚¹{order.totalPrice}</td>
                    <td>
                      <span
                        style={{
                          padding: "6px 12px",
                          borderRadius: "20px",
                          fontSize: "12px",
                          fontWeight: "bold",
                          background:
                            order.status === "Delivered"
                              ? "#d4edda"
                              : "#fff3cd",
                          color:
                            order.status === "Delivered"
                              ? "#155724"
                              : "#856404",
                        }}
                      >
                        {order.status}
                      </span>
                    </td>
                    <td>
                      <ActionButton
                        onClick={() =>
                          handleUpdateOrderStatus(order._id, "Out for Delivery")
                        }
                        title="Ship"
                      >
                        <Truck size={18} />
                      </ActionButton>
                      <ActionButton
                        onClick={() =>
                          handleUpdateOrderStatus(order._id, "Delivered")
                        }
                        title="Complete"
                        style={{ color: "green" }}
                      >
                        <CheckCircle size={18} />
                      </ActionButton>
                      <ActionButton
                        className="delete"
                        onClick={() => handleDeleteOrder(order._id)}
                        title="Delete"
                      >
                        <Trash2 size={18} />
                      </ActionButton>
                    </td>
                  </tr>
                ))}
              </tbody>
            </Table>
          </TableContainer>
        </FormCard>
      )}

      {/* --- PRODUCTS TAB --- */}
      {activeTab === "products" && (
        <>
          <FormCard>
            <FormTitle>Add New Product</FormTitle>
            <form onSubmit={handleProductSubmit}>
              <FormGroup>
                <Label>Name</Label>
                <Input
                  type="text"
                  value={productData.name}
                  onChange={(e) =>
                    setProductData({ ...productData, name: e.target.value })
                  }
                  required
                />
              </FormGroup>
              <div style={{ display: "flex", gap: "10px", flexWrap: "wrap" }}>
                <FormGroup style={{ flex: 1, minWidth: "150px" }}>
                  <Label>Price</Label>
                  <Input
                    type="number"
                    value={productData.price}
                    onChange={(e) =>
                      setProductData({ ...productData, price: e.target.value })
                    }
                    required
                  />
                </FormGroup>
                <FormGroup style={{ flex: 1, minWidth: "150px" }}>
                  <Label>Stock</Label>
                  <Input
                    type="number"
                    value={productData.stock}
                    onChange={(e) =>
                      setProductData({ ...productData, stock: e.target.value })
                    }
                    required
                  />
                </FormGroup>
              </div>
              <FormGroup>
                <Label>Category</Label>
                <Select
                  value={productData.category}
                  onChange={(e) =>
                    setProductData({ ...productData, category: e.target.value })
                  }
                  required
                >
                  <option value="">Select Category</option>
                  {categories.map((c) => (
                    <option key={c._id} value={c.name}>
                      {c.name}
                    </option>
                  ))}
                </Select>
              </FormGroup>
              <FormGroup>
                <Label>Image URL</Label>
                <Input
                  type="text"
                  value={productData.image}
                  onChange={(e) =>
                    setProductData({ ...productData, image: e.target.value })
                  }
                  required
                />
              </FormGroup>
              <FormGroup>
                <Label>Unit</Label>
                <Input
                  type="text"
                  value={productData.unit}
                  onChange={(e) =>
                    setProductData({ ...productData, unit: e.target.value })
                  }
                  required
                />
              </FormGroup>
              <PrimaryButton type="submit">Add Product</PrimaryButton>
            </form>
          </FormCard>

          <FormCard style={{ maxWidth: "100%", marginTop: "30px" }}>
            <FormTitle>Inventory Management</FormTitle>
            <TableContainer>
              <Table>
                <thead>
                  <tr>
                    <th>Product</th>
                    <th>Category</th>
                    <th>Stock Level</th>
                    <th>Actions</th>
                  </tr>
                </thead>
                <tbody>
                  {products.map((p) => (
                    <tr key={p._id}>
                      <td style={{ fontWeight: "bold" }}>{p.name}</td>
                      <td>{p.category}</td>
                      <td>
                        {editStockId === p._id ? (
                          <div
                            style={{
                              display: "flex",
                              alignItems: "center",
                              gap: "5px",
                            }}
                          >
                            <Input
                              type="number"
                              autoFocus
                              style={{
                                width: "80px",
                                padding: "8px",
                                height: "36px",
                                marginBottom: 0,
                              }}
                              value={newStockValue}
                              onChange={(e) => setNewStockValue(e.target.value)}
                            />
                            <ActionButton
                              className="save"
                              onClick={() => handleUpdateStock(p._id)}
                            >
                              <Save size={18} />
                            </ActionButton>
                            <ActionButton onClick={() => setEditStockId(null)}>
                              <X size={18} />
                            </ActionButton>
                          </div>
                        ) : (
                          <span
                            style={{
                              color: p.stock < 10 ? "red" : "inherit",
                              fontWeight: p.stock < 10 ? "bold" : "normal",
                            }}
                          >
                            {p.stock} units
                          </span>
                        )}
                      </td>
                      <td>
                        <ActionButton
                          className="edit"
                          onClick={() => {
                            setEditStockId(p._id);
                            setNewStockValue(p.stock);
                          }}
                        >
                          <Edit3 size={18} />
                        </ActionButton>
                        <ActionButton
                          className="delete"
                          onClick={() => deleteProductHandler(p._id)}
                        >
                          <Trash2 size={18} />
                        </ActionButton>
                      </td>
                    </tr>
                  ))}
                </tbody>
              </Table>
            </TableContainer>
          </FormCard>
        </>
      )}

      {/* --- CATEGORIES TAB --- */}
      {activeTab === "categories" && (
        <FormCard>
          <FormTitle>Create Category</FormTitle>
          <form onSubmit={handleCategorySubmit}>
            <FormGroup>
              <Label>Name</Label>
              <Input
                type="text"
                value={categoryData.name}
                onChange={(e) =>
                  setCategoryData({ ...categoryData, name: e.target.value })
                }
                required
              />
            </FormGroup>
            <FormGroup>
              <Label>Image URL</Label>
              <Input
                type="text"
                value={categoryData.image}
                onChange={(e) =>
                  setCategoryData({ ...categoryData, image: e.target.value })
                }
                required
              />
            </FormGroup>
            <FormGroup>
              <Label>Description</Label>
              <Input
                type="text"
                value={categoryData.desc}
                onChange={(e) =>
                  setCategoryData({ ...categoryData, desc: e.target.value })
                }
              />
            </FormGroup>
            <PrimaryButton type="submit">Create Category</PrimaryButton>
          </form>
        </FormCard>
      )}

      {/* --- USERS TAB --- */}
      {activeTab === "users" && (
        <FormCard style={{ maxWidth: "100%" }}>
          <FormTitle>Registered Users</FormTitle>
          <TableContainer>
            <Table>
              <thead>
                <tr>
                  <th>Name</th>
                  <th>Email</th>
                  <th>Role</th>
                  <th>Action</th>
                </tr>
              </thead>
              <tbody>
                {users.map((u) => (
                  <tr key={u._id}>
                    <td>{u.name}</td>
                    <td>{u.email}</td>
                    <td>
                      {u.isAdmin ? (
                        <span
                          style={{
                            color: "var(--color-primary)",
                            fontWeight: "bold",
                          }}
                        >
                          Admin
                        </span>
                      ) : (
                        "User"
                      )}
                    </td>
                    <td>
                      <ActionButton
                        className="delete"
                        onClick={() => deleteUserHandler(u._id)}
                      >
                        <Trash2 size={18} />
                      </ActionButton>
                    </td>
                  </tr>
                ))}
              </tbody>
            </Table>
          </TableContainer>
        </FormCard>
      )}
    </AdminDashboardContainer>
  );
};

export default AdminDashboard;


--- File: frontend-grocery\src\components\admin\Dashboard\Dashboard-style.js ---

import styled from "styled-components";
import {
  AuthCard,
  Title,
  FormGroup,
  Label,
  Input,
  PrimaryButton,
} from "../../auth/Login/Login-style";

export const AdminDashboardContainer = styled.div`
  padding: 20px;
  max-width: 1200px;
  margin: 0 auto;
`;

export const TabContainer = styled.div`
  display: flex;
  margin-bottom: 30px;
  border-bottom: 2px solid #eee;
  overflow-x: auto; /* Scrollable on mobile */
`;

export const TabButton = styled.button`
  padding: 12px 24px;
  font-size: 1.1rem;
  font-weight: 600;
  color: ${(props) =>
    props.$active ? "var(--color-primary)" : "var(--color-text-light)"};
  border-bottom: 3px solid
    ${(props) => (props.$active ? "var(--color-primary)" : "transparent")};
  margin-right: 5px;
  background: transparent;
  transition: all 0.2s;
  cursor: pointer;
  white-space: nowrap;

  &:hover {
    color: var(--color-primary);
    background-color: #f9f9f9;
  }
`;

export const FormCard = styled(AuthCard)`
  max-width: 800px; /* Wider form for admin */
  margin: 0 auto;
  padding: 30px;

  @media (max-width: 768px) {
    padding: 20px;
  }
`;

export const FormTitle = styled(Title)`
  font-size: 1.8rem;
  margin-bottom: 20px;
  text-align: left;
`;

export const Select = styled.select`
  ${Input};
  height: 48px;
  background-color: var(--color-white);
  cursor: pointer;
`;

// --- NEW TABLE STYLES ---
export const TableContainer = styled.div`
  overflow-x: auto;
  margin-top: 20px;
  border-radius: 8px;
  border: 1px solid #eee;
`;

export const Table = styled.table`
  width: 100%;
  border-collapse: collapse;
  min-width: 600px; /* Force scroll on small screens */

  th,
  td {
    padding: 16px;
    text-align: left;
    border-bottom: 1px solid #eee;
    vertical-align: middle;
  }

  th {
    background-color: #f8f9fa;
    color: var(--color-text-dark);
    font-weight: 700;
    text-transform: uppercase;
    font-size: 0.85rem;
    letter-spacing: 0.5px;
  }

  tr:last-child td {
    border-bottom: none;
  }

  tr:hover {
    background-color: #fafafa;
  }
`;

// --- NEW BIGGER ACTION BUTTONS ---
export const ActionButton = styled.button`
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 36px;
  height: 36px;
  border-radius: 6px;
  border: 1px solid #ddd;
  background-color: white;
  color: var(--color-text-dark);
  cursor: pointer;
  margin-right: 8px;
  transition: all 0.2s;

  &:hover {
    background-color: #f0f0f0;
    transform: translateY(-1px);
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
  }

  &.delete:hover {
    background-color: #ffeaea;
    color: #dc3545;
    border-color: #dc3545;
  }

  &.edit:hover {
    background-color: #eaf4ff;
    color: #007bff;
    border-color: #007bff;
  }

  &.save:hover {
    background-color: #e6fffa;
    color: #28a745;
    border-color: #28a745;
  }
`;

export { FormGroup, Label, Input, PrimaryButton };


--- File: frontend-grocery\src\components\auth\ProtectedRoute.jsx ---

import React from "react";
import { Navigate, useLocation } from "react-router-dom";
import { useAuth } from "../../context/AuthContext";

const ProtectedRoute = ({ children, isAdmin }) => {
  const { user, isAuthenticated, loading } = useAuth();
  const location = useLocation();

  if (loading) return <div>Loading...</div>;

  if (!isAuthenticated) {
    // Redirect to login but save the current location they were trying to go to
    return <Navigate to="/login" state={{ from: location }} replace />;
  }

  if (isAdmin && !user.isAdmin) {
    // If route requires admin but user is not admin, send to user dashboard
    return <Navigate to="/" replace />;
  }

  return children;
};

export default ProtectedRoute;


--- File: frontend-grocery\src\components\auth\Login\Login-component.jsx ---

import React, { useState } from "react";
import { Link, useNavigate } from "react-router-dom";
import { toast } from "react-toastify";
import { useAuth } from "../../../context/AuthContext"; // Import useAuth
import {
  AuthContainer,
  AuthCard,
  Title,
  FormGroup,
  Label,
  Input,
  PrimaryButton,
  HelperText,
} from "./Login-style";

const LoginPage = () => {
  const [formData, setFormData] = useState({
    email: "",
    password: "",
  });
  const [isSubmitting, setIsSubmitting] = useState(false);
  const navigate = useNavigate();
  const { login } = useAuth(); // Destructure login from context

  const { email, password } = formData;

  const handleChange = (e) => {
    setFormData({ ...formData, [e.target.name]: e.target.value });
  };

  const handleSubmit = async (e) => {
    e.preventDefault();
    setIsSubmitting(true);

    try {
      const userData = await login(email, password);
      toast.success(`Welcome back, ${userData.name}!`);

      // Redirect based on role
      if (userData.isAdmin) {
        navigate("/admin");
      } else {
        navigate("/");
      }
    } catch (err) {
      toast.error(err.response?.data?.message || "Invalid email or password");
    } finally {
      setIsSubmitting(false);
    }
  };

  return (
    <AuthContainer>
      <AuthCard>
        <Title>Sign In</Title>
        <form onSubmit={handleSubmit}>
          <FormGroup>
            <Label htmlFor="email">Email Address</Label>
            <Input
              type="email"
              id="email"
              name="email"
              placeholder="e.g., user@example.com"
              value={email}
              onChange={handleChange}
              required
            />
          </FormGroup>

          <FormGroup>
            <Label htmlFor="password">Password</Label>
            <Input
              type="password"
              id="password"
              name="password"
              placeholder="Enter your password"
              value={password}
              onChange={handleChange}
              required
            />
          </FormGroup>

          <PrimaryButton type="submit" disabled={isSubmitting}>
            {isSubmitting ? "Logging in..." : "Login"}
          </PrimaryButton>
        </form>

        <HelperText>
          New to GrocerySub? <Link to="/register">Create an account</Link>
        </HelperText>
      </AuthCard>
    </AuthContainer>
  );
};

export default LoginPage;


--- File: frontend-grocery\src\components\auth\Login\Login-style.js ---

import styled from "styled-components";

export const AuthContainer = styled.div`
  display: flex;
  justify-content: center;
  align-items: center;
  min-height: calc(
    100vh - 60px - 40px
  ); /* Screen height minus Navbar and padding */
  padding: 20px;
`;

export const AuthCard = styled.div`
  background: var(--color-white);
  border-radius: var(--border-radius);
  box-shadow: var(--shadow-medium);
  padding: 40px;
  width: 100%;
  max-width: 400px; /* Standard card width */
  text-align: center;
`;

export const Title = styled.h2`
  color: var(--color-text-dark);
  margin-bottom: 25px;
  font-size: 2rem;
  font-weight: 700;
`;

export const FormGroup = styled.div`
  margin-bottom: 20px;
  text-align: left;
`;

export const Label = styled.label`
  display: block;
  margin-bottom: 8px;
  font-weight: 600;
  color: var(--color-text-dark);
`;

export const Input = styled.input`
  width: 100%;
  padding: 12px;
  border: 1px solid #ddd;
  border-radius: var(--border-radius);
  font-size: 1rem;
  transition: border-color 0.2s;

  &:focus {
    border-color: var(--color-primary);
    box-shadow: 0 0 0 1px var(--color-primary); /* Custom focus ring */
  }
`;

export const PrimaryButton = styled.button`
  width: 100%;
  padding: 12px;
  background-color: var(--color-primary);
  color: var(--color-white);
  border: none;
  border-radius: var(--border-radius);
  font-size: 1rem;
  font-weight: 700;
  cursor: pointer;
  transition: background-color 0.2s, transform 0.1s;
  margin-top: 10px;

  &:hover {
    background-color: var(--color-primary-dark);
    transform: translateY(-1px);
  }

  &:disabled {
    background-color: #f7b489; /* Lighter shade for disabled state */
    cursor: not-allowed;
  }
`;

export const HelperText = styled.p`
  margin-top: 20px;
  font-size: 0.9rem;
  color: var(--color-text-light);

  a {
    font-weight: 600;
  }
`;


--- File: frontend-grocery\src\components\auth\Register\Register-component.jsx ---

import React, { useState } from "react";
import { Link, useNavigate } from "react-router-dom";
import { toast } from "react-toastify";
import { useAuth } from "../../../context/AuthContext";
import {
  AuthContainer,
  AuthCard,
  Title,
  FormGroup,
  Label,
  Input,
  Select,
  PrimaryButton,
  HelperText,
} from "./Register-style";

const RegisterPage = () => {
  const [formData, setFormData] = useState({
    name: "",
    email: "",
    password: "",
    role: "user",
  });
  const [isSubmitting, setIsSubmitting] = useState(false);
  const navigate = useNavigate();
  const { register } = useAuth(); // Destructure register from context

  const { name, email, password, role } = formData;

  const handleChange = (e) => {
    setFormData({ ...formData, [e.target.name]: e.target.value });
  };

  const handleSubmit = async (e) => {
    e.preventDefault();

    if (password.length < 6) {
      toast.error("Password must be at least 6 characters long.");
      return;
    }

    setIsSubmitting(true);
    try {
      await register(name, email, password);
      toast.success("Account created successfully!");
      navigate("/"); // Redirect to dashboard after signup
    } catch (err) {
      toast.error(err.response?.data?.message || "Registration failed");
    } finally {
      setIsSubmitting(false);
    }
  };

  return (
    <AuthContainer>
      <AuthCard>
        <Title>Create Account</Title>
        <form onSubmit={handleSubmit}>
          <FormGroup>
            <Label htmlFor="name">Full Name</Label>
            <Input
              type="text"
              id="name"
              name="name"
              placeholder="Your full name"
              value={name}
              onChange={handleChange}
              required
            />
          </FormGroup>

          <FormGroup>
            <Label htmlFor="email">Email Address</Label>
            <Input
              type="email"
              id="email"
              name="email"
              placeholder="e.g., john.doe@email.com"
              value={email}
              onChange={handleChange}
              required
            />
          </FormGroup>

          <FormGroup>
            <Label htmlFor="password">Password</Label>
            <Input
              type="password"
              id="password"
              name="password"
              placeholder="Minimum 6 characters"
              value={password}
              onChange={handleChange}
              required
            />
          </FormGroup>

          {/* Role is visible for initial setup/demo, usually hidden in production */}
          <FormGroup>
            <Label htmlFor="role">Account Role</Label>
            <Select
              id="role"
              name="role"
              value={role}
              onChange={handleChange}
              required
            >
              <option value="user">Customer (Order Groceries)</option>
              <option value="delivery">Delivery Person</option>
              <option value="admin">Administrator</option>
            </Select>
          </FormGroup>

          <PrimaryButton type="submit" disabled={isSubmitting}>
            {isSubmitting ? "Creating Account..." : "Register"}
          </PrimaryButton>
        </form>

        <HelperText>
          Already have an account? <Link to="/login">Sign in here</Link>
        </HelperText>
      </AuthCard>
    </AuthContainer>
  );
};

export default RegisterPage;


--- File: frontend-grocery\src\components\auth\Register\Register-style.js ---

// We can typically import styles directly from the shared Auth components,
// but sticking strictly to the directory rule:

// --- NOTE: We will reuse common Auth styles defined in Login-style.js ---
// In a large project, we would refactor AuthCard, Input, Button into a shared /components/common folder.
// For now, we will import and extend or define only specific styles.
import styled from "styled-components";
import {
  AuthContainer,
  AuthCard,
  Title,
  FormGroup,
  Label,
  Input,
  PrimaryButton,
  HelperText,
} from "../Login/Login-style";

// Exporting reusable styles
export {
  AuthContainer,
  AuthCard,
  Title,
  FormGroup,
  Label,
  Input,
  PrimaryButton,
  HelperText,
};

// Define the Select component style
export const Select = styled.select`
  width: 100%;
  padding: 12px;
  border: 1px solid #ddd;
  border-radius: var(--border-radius);
  font-size: 1rem;
  background-color: var(--color-white);
  transition: border-color 0.2s;
  appearance: none; /* Remove default arrow on some browsers */
  cursor: pointer;

  &:focus {
    border-color: var(--color-primary);
    box-shadow: 0 0 0 1px var(--color-primary);
  }
`;


--- File: frontend-grocery\src\components\cart\Checkout\Checkout-component.jsx ---

import React, { useState, useEffect } from "react";
import { useNavigate } from "react-router-dom";
import { toast } from "react-toastify";
import { Trash2, Plus, Minus, Home, MapPin } from "lucide-react";
import API from "../../../api/axios";
import { useCart } from "../../../context/CartContext";
import { useAuth } from "../../../context/AuthContext";
import {
  CheckoutContainer,
  Title,
  ContentWrapper,
  CartDetails,
  SummaryCard,
  SectionHeader,
  CartItem,
  ItemInfo,
  ItemPrice,
  SummaryLine,
  CheckoutButton,
  AddressForm,
  InputRow,
  StyledInput,
} from "./Checkout-style";

const CheckoutPage = () => {
  const { cart, updateQty, removeFromCart, clearCart } = useCart();
  const { user } = useAuth();
  const navigate = useNavigate();

  const [useDefault, setUseDefault] = useState(true);
  const [shippingAddress, setShippingAddress] = useState({
    address: "",
    city: "",
    postalCode: "",
  });

  useEffect(() => {
    if (useDefault && user?.defaultAddress) {
      setShippingAddress(user.defaultAddress);
    }
  }, [user, useDefault]);

  const totals = (() => {
    const subtotal =
      cart.orderItems.reduce((acc, i) => acc + i.price * i.qty, 0) +
      cart.subscriptions.reduce((acc, i) => acc + i.price, 0);
    const shipping = subtotal > 499 || subtotal === 0 ? 0 : 40;
    const tax = subtotal * 0.05;
    return { subtotal, shipping, tax, grandTotal: subtotal + shipping + tax };
  })();

  const handleCheckout = async () => {
    if (!shippingAddress.address || !shippingAddress.city)
      return toast.error("Address required");
    try {
      const { data } = await API.post("/orders", {
        orderItems: cart.orderItems,
        subscriptions: cart.subscriptions,
        shippingAddress,
        totalPrice: totals.grandTotal,
        paymentMethod: "Online Payment",
      });
      if (data.success) {
        // Update default address if user was using a custom one but wants to save it
        if (!useDefault)
          await API.put("/users/profile", { defaultAddress: shippingAddress });
        toast.success("Order successful!");
        clearCart();
        navigate("/");
      }
    } catch (err) {
      toast.error(err.response?.data?.message || "Checkout failed");
    }
  };

  return (
    <CheckoutContainer>
      <Title>Checkout Summary</Title>
      <ContentWrapper>
        <CartDetails>
          <SectionHeader>Delivery Address</SectionHeader>
          <div style={{ marginBottom: "20px", display: "flex", gap: "20px" }}>
            <button
              onClick={() => setUseDefault(true)}
              style={{
                flex: 1,
                padding: "10px",
                border: useDefault ? "2px solid #60b246" : "1px solid #ddd",
                background: useDefault ? "#f0fff0" : "#fff",
                borderRadius: "8px",
                cursor: "pointer",
              }}
            >
              <Home size={18} /> Use Default
            </button>
            <button
              onClick={() => {
                setUseDefault(false);
                setShippingAddress({ address: "", city: "", postalCode: "" });
              }}
              style={{
                flex: 1,
                padding: "10px",
                border: !useDefault ? "2px solid #60b246" : "1px solid #ddd",
                background: !useDefault ? "#f0fff0" : "#fff",
                borderRadius: "8px",
                cursor: "pointer",
              }}
            >
              <MapPin size={18} /> Custom Address
            </button>
          </div>

          <AddressForm>
            <InputRow>
              <StyledInput
                placeholder="Address"
                value={shippingAddress.address}
                onChange={(e) =>
                  setShippingAddress({
                    ...shippingAddress,
                    address: e.target.value,
                  })
                }
                disabled={useDefault}
              />
            </InputRow>
            <InputRow>
              <StyledInput
                placeholder="City"
                value={shippingAddress.city}
                disabled={useDefault}
                onChange={(e) =>
                  setShippingAddress({
                    ...shippingAddress,
                    city: e.target.value,
                  })
                }
              />
              <StyledInput
                placeholder="Pincode"
                value={shippingAddress.postalCode}
                disabled={useDefault}
                onChange={(e) =>
                  setShippingAddress({
                    ...shippingAddress,
                    postalCode: e.target.value,
                  })
                }
              />
            </InputRow>
          </AddressForm>

          <SectionHeader>Review Items</SectionHeader>
          {cart.orderItems.map((item) => (
            <CartItem key={item.product}>
              <ItemInfo>
                <h4>{item.name}</h4>
                <div
                  style={{
                    display: "flex",
                    alignItems: "center",
                    gap: "10px",
                    marginTop: "8px",
                  }}
                >
                  <button onClick={() => updateQty(item.product, -1)}>
                    <Minus size={14} />
                  </button>
                  <span>{item.qty}</span>
                  <button onClick={() => updateQty(item.product, 1)}>
                    <Plus size={14} />
                  </button>
                  <Trash2
                    size={18}
                    color="red"
                    onClick={() => removeFromCart(item.product, "once")}
                    style={{ cursor: "pointer", marginLeft: "10px" }}
                  />
                </div>
              </ItemInfo>
              <ItemPrice>â‚¹{(item.price * item.qty).toFixed(2)}</ItemPrice>
            </CartItem>
          ))}
        </CartDetails>

        <SummaryCard>
          <SummaryLine $total>
            Total: â‚¹{totals.grandTotal.toFixed(2)}
          </SummaryLine>
          <CheckoutButton onClick={handleCheckout}>Place Order</CheckoutButton>
        </SummaryCard>
      </ContentWrapper>
    </CheckoutContainer>
  );
};

export default CheckoutPage;


--- File: frontend-grocery\src\components\cart\Checkout\Checkout-style.js ---

import styled from "styled-components";
import { PrimaryButton } from "../../auth/Login/Login-style";

export const CheckoutContainer = styled.div`
  padding: 20px;
  max-width: 1200px;
  margin: 0 auto;
`;

export const Title = styled.h1`
  font-size: 2.5rem;
  color: var(--color-text-dark);
  margin-bottom: 25px;
  border-bottom: 3px solid var(--color-primary);
  display: inline-block;
  padding-bottom: 5px;

  @media (max-width: 768px) {
    font-size: 2rem;
  }
`;

export const ContentWrapper = styled.div`
  display: flex;
  gap: 30px;

  @media (max-width: 992px) {
    flex-direction: column;
  }
`;

export const CartDetails = styled.div`
  flex: 3;
`;

export const SummaryCard = styled.div`
  flex: 1.5;
  background: var(--color-white);
  border-radius: var(--border-radius);
  box-shadow: var(--shadow-light);
  padding: 25px;
  height: fit-content;

  @media (max-width: 992px) {
    order: -1; /* Summary goes to top on mobile */
  }
`;

export const SectionHeader = styled.h2`
  font-size: 1.5rem;
  margin-bottom: 15px;
  color: var(--color-primary-dark);
  border-bottom: 1px solid #eee;
  padding-bottom: 5px;
`;

// --- NEW RESPONSIVE ADDRESS STYLES ---
export const AddressForm = styled.div`
  background: #f9f9f9;
  padding: 20px;
  border-radius: 8px;
  border: 1px solid #ddd;
  margin-bottom: 30px;
`;

export const InputRow = styled.div`
  display: flex;
  gap: 15px;
  margin-bottom: 15px;

  /* Stacks inputs vertically on mobile */
  @media (max-width: 600px) {
    flex-direction: column;
    gap: 15px;
  }
`;

export const StyledInput = styled.input`
  width: 100%;
  padding: 12px;
  border-radius: 6px;
  border: 1px solid #ccc;
  font-size: 1rem;
  transition: border-color 0.2s;

  &:focus {
    outline: none;
    border-color: var(--color-primary);
    box-shadow: 0 0 0 2px rgba(252, 128, 25, 0.2);
  }
`;
// --------------------------------------

export const CartItem = styled.div`
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 15px 0;
  border-bottom: 1px solid #f0f0f0;

  &:last-child {
    border-bottom: none;
  }
`;

export const ItemInfo = styled.div`
  h4 {
    margin: 0;
    font-size: 1.1rem;
    color: var(--color-text-dark);
  }

  p {
    margin: 5px 0 0 0;
    font-size: 0.9rem;
    color: ${(props) =>
      props.$isSub ? "var(--color-primary)" : "var(--color-text-light)"};
    font-weight: ${(props) => (props.$isSub ? "600" : "400")};
  }
`;

export const ItemPrice = styled.div`
  font-size: 1.1rem;
  font-weight: 700;
  color: var(--color-text-dark);
`;

export const SummaryLine = styled.div`
  display: flex;
  justify-content: space-between;
  padding: 8px 0;
  font-size: 1rem;
  font-weight: ${(props) => (props.$total ? "700" : "400")};
  color: ${(props) =>
    props.$total ? "var(--color-primary-dark)" : "var(--color-text-dark)"};

  span.value {
    font-weight: 700;
  }
`;

export const CheckoutButton = styled(PrimaryButton)`
  margin-top: 20px;
  padding: 15px;
  font-size: 1.1rem;
`;


--- File: frontend-grocery\src\components\delivery\Dashboard\Dashboard-component.jsx ---

import React, { useState } from "react";
import { toast } from "react-toastify";
import { Truck, MapPin, Package, CheckCircle } from "lucide-react";
import {
  DeliveryContainer,
  Title,
  OrdersList,
  OrderCard,
  OrderDetails,
  DetailItem,
  OrderStatus,
  ActionButtons,
  StatusButton,
} from "./Dashboard-style";

// Placeholder Order Data
const mockOrders = [
  {
    id: "ORD001",
    customerName: "Alice Johnson",
    address: "123 Main St, Apt 4B",
    status: "assigned",
    items: 5,
    total: 45.99,
  },
  {
    id: "ORD002",
    customerName: "Bob Smith",
    address: "45 Oak Ave, House #2",
    status: "transit",
    items: 3,
    total: 22.5,
  },
  {
    id: "ORD003",
    customerName: "Charlie Brown",
    address: "789 Pine Ln",
    status: "delivered",
    items: 7,
    total: 88.0,
  },
];

const DeliveryDashboard = () => {
  const [orders, setOrders] = useState(mockOrders);

  const updateStatus = (orderId, newStatus) => {
    // --- Future Axios Call (Placeholder Logic) ---
    setOrders((prevOrders) =>
      prevOrders.map((order) =>
        order.id === orderId ? { ...order, status: newStatus } : order
      )
    );

    toast.info(`Order ${orderId} updated to ${newStatus.toUpperCase()}.`);
    // --- End Placeholder Logic ---
  };

  const getStatusLabel = (status) => {
    switch (status) {
      case "assigned":
        return "Assigned";
      case "transit":
        return "In Transit";
      case "delivered":
        return "Delivered";
      default:
        return "Unknown";
    }
  };

  return (
    <DeliveryContainer>
      <Title>Assigned Deliveries</Title>

      <OrdersList>
        {orders.map((order) => (
          <OrderCard key={order.id}>
            <OrderDetails>
              <DetailItem>
                <Package size={16} style={{ marginRight: "5px" }} />
                Order ID: <span>{order.id}</span>
              </DetailItem>
              <DetailItem>
                <MapPin size={16} style={{ marginRight: "5px" }} />
                Customer: <span>{order.customerName}</span>, {order.address}
              </DetailItem>
              <DetailItem>
                Items: <span>{order.items}</span> | Total:{" "}
                <span>${order.total.toFixed(2)}</span>
              </DetailItem>
              <DetailItem>
                Status:{" "}
                <OrderStatus $status={order.status}>
                  {getStatusLabel(order.status)}
                </OrderStatus>
              </DetailItem>
            </OrderDetails>

            <ActionButtons>
              {/* "In Transit" Button */}
              {order.status === "assigned" && (
                <StatusButton
                  className="transit"
                  onClick={() => updateStatus(order.id, "transit")}
                >
                  <Truck size={18} style={{ marginRight: "5px" }} />
                  Start Trip
                </StatusButton>
              )}

              {/* "Delivered" Button */}
              {order.status === "transit" && (
                <StatusButton
                  className="complete"
                  onClick={() => updateStatus(order.id, "delivered")}
                >
                  <CheckCircle size={18} style={{ marginRight: "5px" }} />
                  Mark Delivered
                </StatusButton>
              )}

              {/* Disabled button for completed orders */}
              {order.status === "delivered" && (
                <StatusButton disabled>Completed</StatusButton>
              )}
            </ActionButtons>
          </OrderCard>
        ))}
      </OrdersList>
    </DeliveryContainer>
  );
};

export default DeliveryDashboard;


--- File: frontend-grocery\src\components\delivery\Dashboard\Dashboard-style.js ---

import styled from "styled-components";

export const DeliveryContainer = styled.div`
  padding: 20px;
`;

export const Title = styled.h1`
  font-size: 2.5rem;
  color: var(--color-text-dark);
  margin-bottom: 25px;
  border-bottom: 3px solid var(--color-primary);
  display: inline-block;
  padding-bottom: 5px;
`;

export const OrdersList = styled.div`
  display: flex;
  flex-direction: column;
  gap: 20px;
  margin-top: 20px;
`;

export const OrderCard = styled.div`
  background: var(--color-white);
  border-radius: var(--border-radius);
  box-shadow: var(--shadow-light);
  padding: 20px;
  display: flex;
  flex-direction: column;
  gap: 15px;

  @media (min-width: 768px) {
    flex-direction: row;
    justify-content: space-between;
    align-items: center;
  }
`;

export const OrderDetails = styled.div`
  flex-grow: 1;
  display: flex;
  flex-direction: column;
  gap: 5px;
  min-width: 250px;
`;

export const DetailItem = styled.p`
  font-size: 1rem;
  color: var(--color-text-dark);

  span {
    font-weight: 600;
    // color: var(--color-primary-dark);
    color: black;
  }
`;

export const OrderStatus = styled.span`
  display: inline-block;
  padding: 5px 10px;
  border-radius: 20px;
  font-size: 0.9rem;
  font-weight: 700;
  text-transform: capitalize;
  background-color: ${(props) => {
    switch (props.$status) {
      case "delivered":
        return "var(--color-success)";
      case "transit":
        return "var(--color-primary)";
      case "assigned":
      default:
        return "#ffc107"; /* Yellow for assigned */
    }
  }};
  color: ${(props) =>
    props.$status === "assigned"
      ? "var(--color-text-dark)"
      : "var(--color-white)"};
`;

export const ActionButtons = styled.div`
  display: flex;
  gap: 10px;
  margin-top: 10px;

  @media (min-width: 768px) {
    margin-top: 0;
  }
`;

export const StatusButton = styled.button`
  padding: 8px 15px;
  border-radius: var(--border-radius);
  font-weight: 600;
  transition: background-color 0.2s;

  /* Green for Complete/Delivered */
  &.complete {
    background-color: var(--color-success);
    color: var(--color-white);
    &:hover {
      background-color: #1e7e34;
    }
  }

  /* Orange for Transit */
  &.transit {
    background-color: var(--color-primary);
    color: var(--color-white);
    &:hover {
      background-color: var(--color-primary-dark);
    }
  }

  /* Neutral for current status */
  &:disabled {
    background-color: #ddd;
    color: var(--color-text-light);
    cursor: not-allowed;
  }
`;


--- File: frontend-grocery\src\components\layout\Navbar\Navbar-component.jsx ---

// src/components/layout/Navbar/Navbar-component.jsx

import React, { useState } from "react";
import { Link } from "react-router-dom";
import { useAuth } from "../../../context/AuthContext.jsx";
import { useCart } from "../../../context/CartContext.jsx";
import {
  NavContainer,
  NavWrapper,
  Logo,
  NavMenu,
  NavItem,
  MobileMenuButton,
  CartBadge,
} from "./Navbar-style";
import {
  ShoppingCart,
  User,
  LogIn,
  Menu,
  X,
  Package,
  Truck,
  LogOut,
  Home,
} from "lucide-react";

const Navbar = () => {
  const [isMenuOpen, setIsMenuOpen] = useState(false);
  const { isAuthenticated, userRole, logout } = useAuth();
  const { cartCount } = useCart();

  const toggleMenu = () => setIsMenuOpen(!isMenuOpen);

  const handleLogout = () => {
    logout();
    toggleMenu();
  };

  const getDashboardLink = () => {
    switch (userRole) {
      case "admin":
        return {
          path: "/admin",
          icon: <Package size={20} />,
          label: "Admin Panel",
        };
      case "delivery":
        return {
          path: "/delivery",
          icon: <Truck size={20} />,
          label: "Deliveries",
        };
      case "user":
      default:
        // Regular users don't need a special "Dashboard" link in nav if Home is the dashboard
        return null;
    }
  };

  const dashboardLink = isAuthenticated ? getDashboardLink() : null;

  return (
    <NavContainer>
      <NavWrapper>
        <Logo>
          <Link to="/">
            ðŸ¥¦ Grocery<span style={{ fontWeight: "900" }}>Sub</span>
          </Link>
        </Logo>

        <MobileMenuButton onClick={toggleMenu}>
          {isMenuOpen ? <X size={28} /> : <Menu size={28} />}
        </MobileMenuButton>

        <NavMenu $isOpen={isMenuOpen}>
          <NavItem>
            <Link to="/" onClick={toggleMenu}>
              <Home size={20} />
              Home
            </Link>
          </NavItem>

          {isAuthenticated ? (
            <>
              {dashboardLink && (
                <NavItem>
                  <Link to={dashboardLink.path} onClick={toggleMenu}>
                    {dashboardLink.icon}
                    {dashboardLink.label}
                  </Link>
                </NavItem>
              )}

              {/* Cart Link: Only for Users */}
              {userRole !== "admin" && userRole !== "delivery" && (
                <NavItem>
                  <Link to="/cart" onClick={toggleMenu}>
                    <ShoppingCart size={20} />
                    Cart
                    {/* Hardcoded 2 for demo, connect to CartContext later */}
                    <CartBadge>{cartCount}</CartBadge>
                  </Link>
                </NavItem>
              )}

              <NavItem>
                <button onClick={handleLogout}>
                  <LogOut size={20} />
                  Logout
                </button>
              </NavItem>
            </>
          ) : (
            <>
              <NavItem>
                <Link to="/login" onClick={toggleMenu}>
                  <User size={20} />
                  Login
                </Link>
              </NavItem>
              <NavItem>
                <Link to="/register" onClick={toggleMenu}>
                  <LogIn size={20} />
                  Register
                </Link>
              </NavItem>
            </>
          )}
        </NavMenu>
      </NavWrapper>
    </NavContainer>
  );
};

export default Navbar;


--- File: frontend-grocery\src\components\layout\Navbar\Navbar-style.js ---

// src/components/layout/Navbar/Navbar-style.js

import styled from "styled-components";

export const NavContainer = styled.header`
  background-color: var(--color-white);
  box-shadow: var(--shadow-medium);
  padding: 0 5%;
  position: sticky;
  top: 0;
  z-index: 1000;
`;

export const NavWrapper = styled.div`
  max-width: 1200px;
  margin: 0 auto;
  display: flex;
  justify-content: space-between;
  align-items: center;
  height: 80px;
`;

export const Logo = styled.div`
  a {
    display: flex;
    align-items: center;
    font-size: 1.8rem;
    font-weight: 800;
    color: var(--color-primary);
  }

  span {
    color: var(--color-text-dark);
    margin-left: 5px;
    font-size: 1.2rem;
    font-weight: 500;
  }
`;

export const NavMenu = styled.nav`
  display: flex;
  gap: 20px;
  align-items: center;

  @media (max-width: 768px) {
    display: none;
    flex-direction: column;
    position: absolute;
    top: 80px;
    left: 0;
    width: 100%;
    background-color: var(--color-white);
    box-shadow: var(--shadow-medium);
    padding: 15px 5%;

    ${(props) => props.$isOpen && `display: flex;`}
  }
`;

export const NavItem = styled.div`
  position: relative; /* For badge positioning */

  a,
  button {
    display: flex;
    align-items: center;
    gap: 8px;
    padding: 8px 12px;
    color: var(--color-text-dark);
    font-weight: 600;
    font-size: 1rem;
    transition: color 0.2s, background-color 0.2s;
    border-radius: var(--border-radius);
  }

  a:hover,
  button:hover {
    color: var(--color-primary);
    background-color: #fff0e6;
  }

  button {
    background-color: transparent;
    border: none;
  }
`;

export const MobileMenuButton = styled.button`
  display: none;
  font-size: 1.5rem;
  color: var(--color-text-dark);
  padding: 5px;

  @media (max-width: 768px) {
    display: block;
  }
`;

export const CartBadge = styled.span`
  position: absolute;
  top: 0;
  right: 0;
  background-color: var(--color-primary);
  color: white;
  font-size: 0.75rem;
  font-weight: bold;
  height: 18px;
  min-width: 18px;
  border-radius: 9px;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 0 4px;
  transform: translate(25%, -25%);
`;


--- File: frontend-grocery\src\components\user\Dashboard\Dashboard-component.jsx ---

import React, { useState, useEffect } from "react";
import { useNavigate } from "react-router-dom";
import { toast } from "react-toastify";
import { ShoppingCart, Calendar, ArrowLeft, Package, XCircle } from "lucide-react";
import { useAuth } from "../../../context/AuthContext";
import { useCart } from "../../../context/CartContext";
import API from "../../../api/axios";
import { offers } from "../../../data/groceryData";

// Import styles - make sure TabContainer and TabButton are exported from your style file
import * as Styled from "./Dashboard-style";

const UserDashboard = () => {
  const [activeTab, setActiveTab] = useState("shop");
  const [selectedCategory, setSelectedCategory] = useState(null);
  const [dbProducts, setDbProducts] = useState([]);
  const [dbCategories, setDbCategories] = useState([]);
  const [userSubscriptions, setUserSubscriptions] = useState([]);
  const [loading, setLoading] = useState(true);

  const navigate = useNavigate();
  const { isAuthenticated, userRole } = useAuth();
  const { addToCart, cart } = useCart();

  // 1. Fetch Store Data and Subscriptions
  useEffect(() => {
    const fetchInitialData = async () => {
      try {
        setLoading(true);
        const [prodRes, catRes] = await Promise.all([
          API.get("/products"),
          API.get("/categories/get-categories"),
        ]);

        const validCategories = catRes.data.filter((cat) =>
          prodRes.data.some(
            (prod) => prod.category.toLowerCase() === cat.name.toLowerCase()
          )
        );

        setDbProducts(prodRes.data);
        setDbCategories(validCategories);

        if (isAuthenticated) {
          const subRes = await API.get("/orders/my-subscriptions");
          setUserSubscriptions(subRes.data);
        }
      } catch (err) {
        console.error("Fetch Error:", err);
        toast.error("Failed to load dashboard data");
      } finally {
        setLoading(false);
      }
    };
    fetchInitialData();
  }, [isAuthenticated]);

  // 2. Sync Subscriptions when switching tabs
  useEffect(() => {
    if (activeTab === "subscriptions" && isAuthenticated) {
      const fetchSubs = async () => {
        try {
          const { data } = await API.get("/orders/my-subscriptions");
          setUserSubscriptions(data);
        } catch (err) {
          console.error("Sub Fetch Error:", err);
        }
      };
      fetchSubs();
    }
  }, [activeTab, isAuthenticated]);

  const filteredProducts = selectedCategory
    ? dbProducts.filter(
        (p) => p.category.toLowerCase() === selectedCategory.name.toLowerCase()
      )
    : [];

  const handleAction = (item, type) => {
    if (!isAuthenticated) {
      toast.error("Please Login to continue!");
      navigate("/login");
      return;
    }

    if (userRole === "admin") {
      toast.error("Admins cannot place orders.");
      return;
    }

    if (type === "once") {
      const currentInCart = cart?.orderItems?.find((i) => i.product === item._id);
      const currentQty = currentInCart ? currentInCart.qty : 0;

      if (currentQty + 1 > item.stock) {
        toast.error(`Only ${item.stock} units available.`);
        return;
      }
      addToCart(item, "once");
      toast.success(`${item.name} added to cart!`);
    } else {
      addToCart(item, "sub");
      toast.success(`${item.name} added to subscriptions!`);
    }
  };

  const handleCancelSub = async (subId) => {
    if (window.confirm("Cancel this daily subscription?")) {
      try {
        await API.put(`/orders/subscription/${subId}/cancel`);
        toast.success("Cancelled");
        setUserSubscriptions(prev => 
            prev.map(s => s._id === subId ? { ...s, status: "Cancelled" } : s)
        );
      } catch (err) {
        toast.error("Failed to cancel");
      }
    }
  };

  if (loading) return <div style={{ padding: "100px", textAlign: "center" }}>Loading Dashboard...</div>;

  return (
    <Styled.DashboardContainer>
      {/* Tab Logic using inline fallback if Styled components fail */}
      <div style={{ display: 'flex', gap: '10px', marginBottom: '20px', borderBottom: '1px solid #eee', paddingBottom: '10px' }}>
        <button 
          onClick={() => { setActiveTab("shop"); setSelectedCategory(null); }}
          style={{
            padding: '10px 20px',
            cursor: 'pointer',
            border: 'none',
            borderRadius: '5px',
            background: activeTab === 'shop' ? '#60b246' : '#f4f4f4',
            color: activeTab === 'shop' ? 'white' : 'black',
            display: 'flex', alignItems: 'center', gap: '8px'
          }}
        >
          <ShoppingCart size={18} /> Shop Groceries
        </button>
        <button 
          onClick={() => setActiveTab("subscriptions")}
          style={{
            padding: '10px 20px',
            cursor: 'pointer',
            border: 'none',
            borderRadius: '5px',
            background: activeTab === 'subscriptions' ? '#60b246' : '#f4f4f4',
            color: activeTab === 'subscriptions' ? 'white' : 'black',
            display: 'flex', alignItems: 'center', gap: '8px'
          }}
        >
          <Calendar size={18} /> My Subscriptions
        </button>
      </div>

      {activeTab === "shop" && (
        <>
          {!selectedCategory && (
            <Styled.HeroSection>
              <Styled.HeroText>
                <h1>Groceries Delivered in 10 Mins</h1>
                <p>Use code <strong>{offers[0].code}</strong> to {offers[0].desc}</p>
              </Styled.HeroText>
              <div style={{ fontSize: "60px" }}>ðŸ”¥</div>
            </Styled.HeroSection>
          )}

          {!selectedCategory ? (
            <>
              <Styled.SectionTitle>Shop by Category</Styled.SectionTitle>
              <Styled.Grid>
                {dbCategories.map((cat) => (
                  <Styled.CategoryCard key={cat._id} onClick={() => setSelectedCategory(cat)}>
                    <img src={cat.image} alt={cat.name} />
                    <h3>{cat.name}</h3>
                    <p>{cat.desc}</p>
                  </Styled.CategoryCard>
                ))}
              </Styled.Grid>
            </>
          ) : (
            <>
              <Styled.BackButton onClick={() => setSelectedCategory(null)}>
                <ArrowLeft size={18} /> Back
              </Styled.BackButton>
              <Styled.SectionTitle>{selectedCategory.name}</Styled.SectionTitle>
              <Styled.Grid>
                {filteredProducts.map((item) => (
                  <Styled.ProductCard key={item._id}>
                    <img src={item.image} alt={item.name} />
                    <Styled.ProductInfo>
                      <h3>{item.name}</h3>
                      <div className="price">â‚¹{item.price} / {item.unit}</div>
                      <div style={{ fontSize: "0.8rem", color: item.stock < 10 ? "red" : "green" }}>
                        {item.stock > 0 ? `${item.stock} in stock` : "Out of Stock"}
                      </div>
                    </Styled.ProductInfo>
                    <Styled.ActionButtons>
                      <button className="add-btn" onClick={() => handleAction(item, "once")} disabled={item.stock === 0}>
                        ADD
                      </button>
                      <button className="sub-btn" onClick={() => handleAction(item, "sub")}>
                        SUBSCRIBE
                      </button>
                    </Styled.ActionButtons>
                  </Styled.ProductCard>
                ))}
              </Styled.Grid>
            </>
          )}
        </>
      )}

      {activeTab === "subscriptions" && (
        <div style={{ padding: "20px" }}>
          <Styled.SectionTitle>My Ongoing Subscriptions</Styled.SectionTitle>
          {userSubscriptions.length === 0 ? (
            <div style={{textAlign: 'center', padding: '40px'}}>
                <Package size={48} color="#ccc" />
                <p>No active subscriptions.</p>
            </div>
          ) : (
            <div style={{ background: 'white', borderRadius: '10px', boxShadow: '0 2px 10px rgba(0,0,0,0.1)', overflow: 'hidden' }}>
              <table style={{ width: '100%', borderCollapse: 'collapse' }}>
                <thead style={{ background: '#f8f9fa' }}>
                  <tr style={{ textAlign: 'left' }}>
                    <th style={{ padding: '15px' }}>Product</th>
                    <th>Frequency</th>
                    <th>Status</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  {userSubscriptions.map((sub) => (
                    <tr key={sub._id} style={{ borderTop: '1px solid #eee' }}>
                      <td style={{ padding: '15px' }}>{sub.product?.name}</td>
                      <td>{sub.frequency}</td>
                      <td>
                        <span style={{ color: sub.status === "Active" ? "green" : "red", fontWeight: 'bold' }}>
                          {sub.status}
                        </span>
                      </td>
                      <td>
                        {sub.status === "Active" && (
                          <button onClick={() => handleCancelSub(sub._id)} style={{ color: 'red', border: '1px solid red', padding: '5px', borderRadius: '4px', background: 'none', cursor: 'pointer' }}>
                            Cancel
                          </button>
                        )}
                      </td>
                    </tr>
                  ))}
                </tbody>
              </table>
            </div>
          )}
        </div>
      )}
    </Styled.DashboardContainer>
  );
};

export default UserDashboard;

--- File: frontend-grocery\src\components\user\Dashboard\Dashboard-style.js ---

// src/components/user/Dashboard/Dashboard-style.js

import styled from "styled-components";

export const DashboardContainer = styled.div`
  padding: 0;
`;

// --- Hero & Offers Section ---
export const HeroSection = styled.div`
  background: #171a29;
  color: white;
  padding: 40px;
  border-radius: 16px;
  margin-bottom: 40px;
  display: flex;
  align-items: center;
  justify-content: space-between;
  box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);

  @media (max-width: 768px) {
    flex-direction: column;
    text-align: center;
    gap: 20px;
    padding: 24px;
  }
`;

export const HeroText = styled.div`
  h1 {
    font-size: 2.5rem;
    margin-bottom: 10px;
    color: #fff;
  }
  p {
    color: #a9abb3;
    font-size: 1.1rem;
  }
  strong {
    color: var(--color-primary);
  }
`;

// --- Categories Grid ---
export const SectionTitle = styled.h2`
  font-size: 1.8rem;
  font-weight: 800;
  color: #282c3f;
  margin-bottom: 24px;
  border-bottom: 3px solid var(--color-primary);
  display: inline-block;
  padding-bottom: 5px;
`;

export const Grid = styled.div`
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
  gap: 30px;
  margin-bottom: 40px;
`;

export const CategoryCard = styled.div`
  cursor: pointer;
  background: white;
  border-radius: 16px;
  overflow: hidden;
  transition: transform 0.2s, box-shadow 0.2s;
  box-shadow: var(--shadow-light);

  &:hover {
    transform: translateY(-5px);
    box-shadow: var(--shadow-medium);
  }

  img {
    width: 100%;
    height: 180px;
    object-fit: cover;
  }

  h3 {
    font-size: 1.2rem;
    color: #3d4152;
    margin: 15px;
  }

  p {
    font-size: 0.9rem;
    color: #7e808c;
    margin: 0 15px 15px;
  }
`;

// --- Product Listing & Buttons ---
export const BackButton = styled.button`
  background: white;
  border: 1px solid #d4d5d9;
  padding: 8px 20px;
  border-radius: 8px;
  cursor: pointer;
  margin-bottom: 20px;
  font-weight: 600;
  color: var(--color-primary);
  display: flex;
  align-items: center;
  gap: 8px;

  &:hover {
    background: #fff0e6;
    border-color: var(--color-primary);
  }
`;

export const ProductCard = styled.div`
  background: var(--color-white);
  border-radius: 12px;
  box-shadow: var(--shadow-light);
  overflow: hidden;
  transition: transform 0.2s;
  display: flex;
  flex-direction: column;

  &:hover {
    transform: translateY(-4px);
    box-shadow: var(--shadow-medium);
  }

  img {
    width: 100%;
    height: 160px;
    object-fit: cover;
  }
`;

export const ProductInfo = styled.div`
  padding: 15px;
  flex: 1;

  h3 {
    font-size: 1.1rem;
    margin-bottom: 5px;
    color: #3d4152;
  }
  .price {
    font-size: 1.2rem;
    color: #282c3f;
    font-weight: 700;
  }
  .unit {
    font-size: 0.85rem;
    color: #999;
    font-weight: 400;
    margin-left: 5px;
  }
`;

export const ActionButtons = styled.div`
  padding: 15px;
  border-top: 1px solid #f0f0f0;
  display: flex;
  flex-direction: column;
  gap: 10px;

  button {
    width: 100%;
    padding: 10px;
    border: none;
    border-radius: 6px;
    font-weight: 600;
    cursor: pointer;
    font-size: 0.9rem;
    transition: background 0.2s;
  }

  .add-btn {
    background: white;
    border: 1px solid #60b246; /* Green for add */
    color: #60b246;
    &:hover {
      background: #f0fff4;
    }
  }

  .sub-btn {
    background: #fff5e6; /* Light orange */
    border: 1px solid var(--color-primary);
    color: var(--color-primary);
    &:hover {
      background: #ffe0cc;
    }
  }
`;

// --- Footer ---
export const FooterInfo = styled.div`
  margin-top: 60px;
  padding-top: 40px;
  border-top: 1px solid #e9e9eb;
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 40px;

  h4 {
    color: #3d4152;
    margin-bottom: 16px;
  }

  p {
    color: #7e808c;
    font-size: 14px;
    margin-bottom: 8px;
    cursor: pointer;
    &:hover {
      color: var(--color-primary);
    }
  }
`;

export const TabContainer = styled.div`
  display: flex;
  gap: 15px;
  margin-bottom: 20px;
`;

export const TabButton = styled.button`
  padding: 10px 20px;
  border-radius: 8px;
  border: none;
  background: ${(props) => (props.$active ? "var(--color-primary)" : "#eee")};
  color: ${(props) => (props.$active ? "white" : "black")};
  cursor: pointer;
`;


--- File: frontend-grocery\src\context\AuthContext.jsx ---

import React, { createContext, useContext, useState, useEffect } from "react";
import API from "../api/axios";

const AuthContext = createContext();

export const AuthProvider = ({ children }) => {
  const [user, setUser] = useState(null);
  const [loading, setLoading] = useState(true);

  // Check for saved user session on app load
  useEffect(() => {
    const savedUser = localStorage.getItem("userInfo");
    if (savedUser) {
      const parsedUser = JSON.parse(savedUser);
      setUser(parsedUser);
      // Set the token for all future API calls
      API.defaults.headers.common[
        "Authorization"
      ] = `Bearer ${parsedUser.token}`;
    }
    setLoading(false);
  }, []);

  // Login API Call
  const login = async (email, password) => {
    const { data } = await API.post("/users/login", { email, password });
    setUser(data);
    localStorage.setItem("userInfo", JSON.stringify(data));
    API.defaults.headers.common["Authorization"] = `Bearer ${data.token}`;
    return data;
  };

  // Register API Call
  const register = async (name, email, password) => {
    const { data } = await API.post("/users", { name, email, password });
    setUser(data);
    localStorage.setItem("userInfo", JSON.stringify(data));
    API.defaults.headers.common["Authorization"] = `Bearer ${data.token}`;
    return data;
  };

  const logout = () => {
    setUser(null);
    localStorage.removeItem("userInfo");
    delete API.defaults.headers.common["Authorization"];
  };

  return (
    <AuthContext.Provider
      value={{
        user,
        login,
        register,
        logout,
        isAuthenticated: !!user,
        userRole: user?.isAdmin ? "admin" : "user", // Basic role mapping
        loading,
      }}
    >
      {!loading && children}
    </AuthContext.Provider>
  );
};

export const useAuth = () => useContext(AuthContext);


--- File: frontend-grocery\src\context\CartContext.jsx ---

import React, { createContext, useContext, useState, useEffect } from "react";
import { toast } from "react-toastify";
import API from "../api/axios";
import { useAuth } from "./AuthContext";

const CartContext = createContext();

export const CartProvider = ({ children }) => {
  const [cart, setCart] = useState({ orderItems: [], subscriptions: [] });
  const { user } = useAuth();

  // 1. Fetch cart from DB on login
  useEffect(() => {
    const fetchCart = async () => {
      if (user) {
        try {
          const { data } = await API.get("/users/cart");
          if (data) setCart(data);
        } catch (err) {
          console.error("Failed to fetch cart from server");
        }
      } else {
        // Fallback to local storage for guests
        const savedCart = localStorage.getItem("cart");
        if (savedCart) setCart(JSON.parse(savedCart));
      }
    };
    fetchCart();
  }, [user]);

  // 2. Sync cart to DB and LocalStorage on changes
  useEffect(() => {
    const syncCart = async () => {
      localStorage.setItem("cart", JSON.stringify(cart));
      if (user) {
        try {
          await API.post("/users/cart", cart);
        } catch (err) {
          console.error("Failed to sync cart to server");
        }
      }
    };
    syncCart();
  }, [cart, user]);

  const addToCart = (item, type) => {
    setCart((prev) => {
      if (type === "once") {
        const exist = prev.orderItems.find((i) => i.product === item._id);
        const currentQty = exist ? exist.qty : 0;

        if (currentQty + 1 > item.stock) {
          toast.error(`Only ${item.stock} left in stock.`);
          return prev;
        }

        if (exist) {
          return {
            ...prev,
            orderItems: prev.orderItems.map((i) =>
              i.product === item._id ? { ...i, qty: i.qty + 1 } : i
            ),
          };
        }
        return {
          ...prev,
          orderItems: [
            ...prev.orderItems,
            {
              product: item._id,
              name: item.name,
              price: item.price,
              image: item.image,
              qty: 1,
              stock: item.stock,
            },
          ],
        };
      } else {
        const exist = prev.subscriptions.find((s) => s.product === item._id);
        if (exist) {
          toast.info("Already in subscriptions");
          return prev;
        }
        return {
          ...prev,
          subscriptions: [
            ...prev.subscriptions,
            {
              product: item._id,
              name: item.name,
              price: item.price,
              image: item.image,
              frequency: "Daily",
            },
          ],
        };
      }
    });
  };

  const updateQty = (id, delta) => {
    setCart((prev) => ({
      ...prev,
      orderItems: prev.orderItems.map((item) => {
        if (item.product === id) {
          const newQty = item.qty + delta;
          if (delta > 0 && newQty > item.stock) {
            toast.error("Maximum stock reached");
            return item;
          }
          return { ...item, qty: Math.max(1, newQty) };
        }
        return item;
      }),
    }));
  };

  const removeFromCart = (id, type) => {
    setCart((prev) => ({
      ...prev,
      [type === "once" ? "orderItems" : "subscriptions"]: prev[
        type === "once" ? "orderItems" : "subscriptions"
      ].filter((x) => x.product !== id),
    }));
  };

  const clearCart = () => setCart({ orderItems: [], subscriptions: [] });

  return (
    <CartContext.Provider
      value={{
        cart,
        addToCart,
        updateQty,
        removeFromCart,
        clearCart,
        cartCount: cart.orderItems.length + cart.subscriptions.length,
      }}
    >
      {children}
    </CartContext.Provider>
  );
};

export const useCart = () => useContext(CartContext);


--- File: frontend-grocery\src\data\groceryData.js ---

// src/data/groceryData.js

export const categories = [
  {
    id: 1,
    name: "Fresh Vegetables",
    image: "https://images.unsplash.com/photo-1566385101042-1a0aa0c1268c?auto=format&fit=crop&q=80&w=300",
    desc: "Farm fresh veggies direct from the field.",
  },
  {
    id: 2,
    name: "Fresh Fruits",
    image: "https://images.unsplash.com/photo-1619566636858-adf3ef46400b?auto=format&fit=crop&q=80&w=300",
    desc: "Seasonal, exotic, and daily fruits.",
  },
  {
    id: 3,
    name: "Dairy & Breakfast",
    image: "https://images.unsplash.com/photo-1628088062854-d1870b4553da?auto=format&fit=crop&q=80&w=300",
    desc: "Milk, Curd, Bread, Eggs & Butter.",
  },
  {
    id: 4,
    name: "Munchies & Snacks",
    image: "https://images.unsplash.com/photo-1621447504864-d8686e12698c?auto=format&fit=crop&q=80&w=300",
    desc: "Chips, Biscuits, Namkeen & Popcorn.",
  },
];

export const products = [
  // Vegetables
  {
    id: 101,
    categoryId: 1,
    name: "Potato (Aloo)",
    price: 30,
    unit: "1 kg",
    image: "https://images.unsplash.com/photo-1518977676601-b53f82aba655?auto=format&fit=crop&q=80&w=300",
    isSubscriptionAvailable: true,
  },
  {
    id: 102,
    categoryId: 1,
    name: "Onion",
    price: 40,
    unit: "1 kg",
    image: "https://images.unsplash.com/photo-1618512496248-a07fe83aa8cb?auto=format&fit=crop&q=80&w=300",
    isSubscriptionAvailable: true,
  },
  {
    id: 103,
    categoryId: 1,
    name: "Tomato",
    price: 25,
    unit: "1 kg",
    image: "https://images.unsplash.com/photo-1592924357228-91a4daadcfea?auto=format&fit=crop&q=80&w=300",
    isSubscriptionAvailable: true,
  },
  
  // Fruits
  {
    id: 201,
    categoryId: 2,
    name: "Banana",
    price: 60,
    unit: "1 Dozen",
    image: "https://images.unsplash.com/photo-1571771894821-ce9b6c11b08e?auto=format&fit=crop&q=80&w=300",
    isSubscriptionAvailable: true,
  },
  {
    id: 202,
    categoryId: 2,
    name: "Apple (Royal Gala)",
    price: 180,
    unit: "1 kg",
    image: "https://images.unsplash.com/photo-1560806887-1e4cd0b6cbd6?auto=format&fit=crop&q=80&w=300",
    isSubscriptionAvailable: false, // One time only
  },

  // Dairy
  {
    id: 301,
    categoryId: 3,
    name: "Full Cream Milk",
    price: 64,
    unit: "1 Liter",
    image: "https://images.unsplash.com/photo-1563636619-e9143da7973b?auto=format&fit=crop&q=80&w=300",
    isSubscriptionAvailable: true,
  },
  {
    id: 302,
    categoryId: 3,
    name: "Brown Bread",
    price: 45,
    unit: "1 Packet",
    image: "https://images.unsplash.com/photo-1509440159596-0249088772ff?auto=format&fit=crop&q=80&w=300",
    isSubscriptionAvailable: true,
  },
];

export const offers = [
  { id: 1, code: "WELCOME50", desc: "Get 50% OFF on your first order" },
  { id: 2, code: "FREEDEL", desc: "Free Delivery on orders above â‚¹499" },
];

--- File: frontend-grocery\src\styles\GlobalStyle.js ---

import { createGlobalStyle } from "styled-components";

export const GlobalStyle = createGlobalStyle`
    /* --- THEME VARIABLES --- */
    :root {
        --color-primary: #fc8019; /* Swiggy Orange */
        --color-primary-dark: #e06c10;
        --color-text-dark: #3f4255; /* Dark Gray for main text */
        --color-text-light: #808080;
        --color-background: #f1f2f6; /* Off-white/Light Gray background */
        --color-white: #ffffff;
        --color-success: #28a745;
        --color-danger: #dc3545;
        --border-radius: 6px;
        --shadow-light: 0 1px 3px rgba(0, 0, 0, 0.08);
        --shadow-medium: 0 4px 12px rgba(0, 0, 0, 0.1);
    }

    /* --- GLOBAL RESET & BASE STYLES --- */
    * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
    }

    body {
        font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;
        background-color: var(--color-background);
        color: var(--color-text-dark);
        line-height: 1.6;
    }

    /* Standardizes form element appearance */
    input, button, textarea, select {
        font-family: inherit;
        font-size: 100%;
    }

    /* Removes default blue focus outline and replaces with a themed outline */
    *:focus {
        outline: none;
        box-shadow: 0 0 0 2px rgba(252, 128, 25, 0.4); /* Primary color focus ring */
    }

    h1, h2, h3, h4, h5, h6 {
        color: var(--color-text-dark);
        margin-bottom: 0.5rem;
        font-weight: 700;
    }

    a {
        text-decoration: none;
        color: var(--color-primary);
        transition: color 0.2s;
    }

    button {
        cursor: pointer;
        border: none;
        background-color: transparent;
    }
`;


